
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A simple async ORM with fastapi in mind and pydantic validation.">
      
      
      
        <link rel="canonical" href="https://collerek.github.io/ormar/latest/api/relations/">
      
      
        <link rel="prev" href="../queryset/utils/">
      
      
        <link rel="next" href="alias_manager/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>relations - ormar</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-72514911-3"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-72514911-3",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-72514911-3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ormar.relations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ormar" class="md-header__button md-logo" aria-label="ormar" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ormar
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              relations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/collerek/ormar" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    collerek/ormar
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ormar" class="md-nav__button md-logo" aria-label="ormar" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ormar
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/collerek/ormar" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    collerek/ormar
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Definition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/inheritance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inheritance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/migrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migrations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/internals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Fields
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Fields
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/common-parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Common parameters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/field-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fields types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/pydantic-fields/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pydantic only fields
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/encryption/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fields encryption
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Relations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Relations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Relation types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/foreign-key/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ForeignKey
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/many-to-many/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ManyToMany
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/postponed-annotations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Postponed annotations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/queryset-proxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QuerySetProxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../queries/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Queries
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Queries
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Insert data into database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/read/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Read data from database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/update/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Update data in database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/delete/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Delete data from database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/joins-and-subqueries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Joins and subqueries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/filter-and-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Filtering and sorting data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/select-columns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Selecting subset of columns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/pagination-and-rows-number/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pagination and rows number
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/aggregations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aggregation functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/raw-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Return raw data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../signals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Signals
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transactions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transactions
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Use with Fastapi
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Use with Fastapi
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using ormar in responses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/requests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using ormar in requests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use with mypy
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migration to v 0.20
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyCharm plugin
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Release Notes
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" checked>
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Api (BETA)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    Api (BETA)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    ormar
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1" id="__nav_15_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_15_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    ormar
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../databases/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    databases
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_1" id="__nav_15_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../databases/connection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    connection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../databases/query_executor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    query_executor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../databases/transaction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    transaction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../decorators/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    decorators
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_2" id="__nav_15_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    decorators
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../decorators/signals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    signals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../fields/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    fields
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_4" id="__nav_15_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    fields
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    constraints
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/foreign_key/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    foreign_key
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/many_to_many/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    many_to_many
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/model_fields/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    model_fields
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/parsers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    parsers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/referential_actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    referential_actions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/sqlalchemy_encrypted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sqlalchemy_encrypted
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/sqlalchemy_uuid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sqlalchemy_uuid
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/through_field/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    through_field
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    models
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_5" id="__nav_15_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_5_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/descriptors/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    descriptors
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_5_1" id="__nav_15_1_5_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    descriptors
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/descriptors/descriptors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    descriptors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/excludable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    excludable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_5_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/helpers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    helpers
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_5_3" id="__nav_15_1_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    helpers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/helpers/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/helpers/pydantic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pydantic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/helpers/related_names_validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    related_names_validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/helpers/relations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    relations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/helpers/sqlalchemy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sqlalchemy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/helpers/validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/metaclass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    metaclass
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_5_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/mixins/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    mixins
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_5_5" id="__nav_15_1_5_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    mixins
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/mixins/alias_mixin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    alias_mixin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/mixins/excludable_mixin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    excludable_mixin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/mixins/merge_mixin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    merge_mixin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/mixins/pydantic_mixin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pydantic_mixin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/mixins/relation_mixin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    relation_mixin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/mixins/save_mixin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    save_mixin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/model_row/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    model_row
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/modelproxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    modelproxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/newbasemodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    newbasemodel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/ormar_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ormar_config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/quick_access_views/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    quick_access_views
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/traversible/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    traversible
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../protocols/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    protocols
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_6" id="__nav_15_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    protocols
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protocols/queryset_protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    queryset_protocol
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protocols/relation_protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    relation_protocol
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../queryset/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    queryset
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_7" id="__nav_15_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    queryset
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_7_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../queryset/actions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    actions
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_7_1" id="__nav_15_1_7_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_7_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    actions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/actions/filter_action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    filter_action
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/actions/order_action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    order_action
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/actions/query_action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    query_action
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/actions/select_action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    select_action
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/clause/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    clause
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/field_accessor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    field_accessor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/join/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    join
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_7_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../queryset/queries/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    queries
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_7_5" id="__nav_15_1_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_7_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    queries
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/queries/filter_query/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    filter_query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/queries/limit_query/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    limit_query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/queries/offset_query/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    offset_query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/queries/order_query/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    order_query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/queries/prefetch_query/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    prefetch_query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/queries/query/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/queryset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    queryset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/reverse_alias_resolver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    reverse_alias_resolver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../queryset/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_8" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  
  <span class="md-ellipsis">
    
  
    relations
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_15_1_8" id="__nav_15_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    relations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="alias_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    alias_manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="querysetproxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    querysetproxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="relation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    relation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="relation_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    relation_manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="relation_proxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    relation_proxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../signals/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    signals
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_9" id="__nav_15_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    signals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../signals/signal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    signal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../warnings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    warnings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ormar.relations" class="md-nav__link">
    <span class="md-ellipsis">
      
        relations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.relations.AliasManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        AliasManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AliasManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ormar.relations.AliasManager.reversed_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      
        reversed_aliases
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.AliasManager.add_alias" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_alias
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.AliasManager.add_relation_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_relation_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.AliasManager.prefixed_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        prefixed_columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.AliasManager.prefixed_table_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        prefixed_table_name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.AliasManager.resolve_relation_alias" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve_relation_alias
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.AliasManager.resolve_relation_alias_after_complex" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve_relation_alias_after_complex
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.relations.Relation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Relation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Relation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ormar.relations.Relation.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.Relation.add" class="md-nav__link">
    <span class="md-ellipsis">
      
        add
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.Relation.get" class="md-nav__link">
    <span class="md-ellipsis">
      
        get
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.Relation.remove" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.relations.RelationType" class="md-nav__link">
    <span class="md-ellipsis">
      
        RelationType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.relations.RelationsManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        RelationsManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RelationsManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ormar.relations.RelationsManager.__contains__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __contains__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.RelationsManager.add" class="md-nav__link">
    <span class="md-ellipsis">
      
        add
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.RelationsManager.get" class="md-nav__link">
    <span class="md-ellipsis">
      
        get
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.RelationsManager.remove" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.relations.RelationsManager.remove_parent" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove_parent
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.relations.get_relations_sides_and_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_relations_sides_and_names
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>relations</h1>

<div class="doc doc-object doc-module">



<a id="ormar.relations"></a>
    <div class="doc doc-contents first">

        <p>Package handles relations on models, returning related models on calls and exposing
QuerySetProxy for m2m and reverse relations.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="ormar.relations.AliasManager" class="doc doc-heading">
            <code>AliasManager</code>


</h2>


    <div class="doc doc-contents ">



        <p>Keep all aliases of relations between different tables.
One global instance is shared between all models.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>ormar/relations/alias_manager.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AliasManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Keep all aliases of relations between different tables.</span>
<span class="sd">    One global instance is shared between all models.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reversed_aliases</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixed_tables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NamedFromClause</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reversed_aliases</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns swapped key-value pairs from aliases where alias is the key.</span>

<span class="sd">        :return: dictionary of prefix to relation</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reversed_aliases</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reversed_aliases</span>
        <span class="n">reversed_aliases</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reversed_aliases</span> <span class="o">=</span> <span class="n">reversed_aliases</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reversed_aliases</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">prefixed_columns</span><span class="p">(</span>
        <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Label</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a list of aliases sqlalchemy text clauses from</span>
<span class="sd">        string alias and sqlalchemy.Table.</span>

<span class="sd">        Optional list of fields to include can be passed to extract only those columns.</span>
<span class="sd">        List has to have sqlalchemy names of columns (ormar aliases) not the ormar ones.</span>

<span class="sd">        :param alias: alias of given table</span>
<span class="sd">        :type alias: str</span>
<span class="sd">        :param table: table from which fields should be aliased</span>
<span class="sd">        :type table: sqlalchemy.Table</span>
<span class="sd">        :param fields: fields to include</span>
<span class="sd">        :type fields: Optional[List[str]]</span>
<span class="sd">        :return: list of sqlalchemy text clauses with &quot;column name as aliased name&quot;</span>
<span class="sd">        :rtype: List[text]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alias</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">_&quot;</span> <span class="k">if</span> <span class="n">alias</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">aliased_fields</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alias</span><span class="si">}{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span> <span class="k">if</span> <span class="n">fields</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">all_columns</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">table</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span>
            <span class="k">else</span> <span class="p">[</span>
                <span class="n">col</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span>
                <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">fields</span> <span class="ow">or</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">aliased_fields</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">column</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alias</span><span class="si">}{</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">all_columns</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">prefixed_table_name</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">Table</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NamedFromClause</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates text clause with table name with aliased name.</span>

<span class="sd">        :param alias: alias of given table</span>
<span class="sd">        :type alias: str</span>
<span class="sd">        :param table: table</span>
<span class="sd">        :type table: sqlalchemy.Table</span>
<span class="sd">        :return: sqlalchemy text clause as &quot;table_name aliased_name&quot;</span>
<span class="sd">        :rtype: sqlalchemy text clause</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">full_alias</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">full_alias</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixed_tables</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">full_alias</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_relation_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source_model</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span>
        <span class="n">relation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">reverse_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers the relations defined in ormar models.</span>
<span class="sd">        Given the relation it registers also the reverse side of this relation.</span>

<span class="sd">        Used by both ForeignKey and ManyToMany relations.</span>

<span class="sd">        Each relation is registered as Model name and relation name.</span>
<span class="sd">        Each alias registered has to be unique.</span>

<span class="sd">        Aliases are used to construct joins to assure proper links between tables.</span>
<span class="sd">        That way you can link to the same target tables from multiple fields</span>
<span class="sd">        on one model as well as from multiple different models in one join.</span>

<span class="sd">        :param source_model: model with relation defined</span>
<span class="sd">        :type source_model: source Model</span>
<span class="sd">        :param relation_name: name of the relation to define</span>
<span class="sd">        :type relation_name: str</span>
<span class="sd">        :param reverse_name: name of related_name fo given relation for m2m relations</span>
<span class="sd">        :type reverse_name: Optional[str]</span>
<span class="sd">        :return: none</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parent_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">source_model</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">parent_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_alias</span><span class="p">(</span><span class="n">parent_key</span><span class="p">)</span>

        <span class="n">to_field</span> <span class="o">=</span> <span class="n">source_model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span>
        <span class="n">child_model</span> <span class="o">=</span> <span class="n">to_field</span><span class="o">.</span><span class="n">to</span>
        <span class="n">child_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">child_model</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">reverse_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">child_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_alias</span><span class="p">(</span><span class="n">child_key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds alias to the dictionary of aliases under given key.</span>

<span class="sd">        :param alias_key: key of relation to generate alias for</span>
<span class="sd">        :type alias_key: str</span>
<span class="sd">        :return: generated alias</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alias</span> <span class="o">=</span> <span class="n">get_table_alias</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="p">[</span><span class="n">alias_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">alias</span>
        <span class="k">return</span> <span class="n">alias</span>

    <span class="k">def</span> <span class="nf">resolve_relation_alias</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">from_model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;ModelRow&quot;</span><span class="p">]],</span> <span class="n">relation_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given model and relation name returns the alias for this relation.</span>

<span class="sd">        :param from_model: model with relation defined</span>
<span class="sd">        :type from_model: source Model</span>
<span class="sd">        :param relation_name: name of the relation field</span>
<span class="sd">        :type relation_name: str</span>
<span class="sd">        :return: alias of the relation</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">from_model</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">alias</span>

    <span class="k">def</span> <span class="nf">resolve_relation_alias_after_complex</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source_model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;ModelRow&quot;</span><span class="p">]],</span>
        <span class="n">relation_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">relation_field</span><span class="p">:</span> <span class="s2">&quot;ForeignKeyField&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given source model and relation string returns the alias for this complex</span>
<span class="sd">        relation if it exists, otherwise fallback to normal relation from a relation</span>
<span class="sd">        field definition.</span>

<span class="sd">        :param relation_field: field with direct relation definition</span>
<span class="sd">        :type relation_field: &quot;ForeignKeyField&quot;</span>
<span class="sd">        :param source_model: model with query starts</span>
<span class="sd">        :type source_model: source Model</span>
<span class="sd">        :param relation_str: string with relation joins defined</span>
<span class="sd">        :type relation_str: str</span>
<span class="sd">        :return: alias of the relation</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">relation_str</span> <span class="ow">and</span> <span class="s2">&quot;__&quot;</span> <span class="ow">in</span> <span class="n">relation_str</span><span class="p">:</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_relation_alias</span><span class="p">(</span>
                <span class="n">from_model</span><span class="o">=</span><span class="n">source_model</span><span class="p">,</span> <span class="n">relation_name</span><span class="o">=</span><span class="n">relation_str</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">alias</span><span class="p">:</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_relation_alias</span><span class="p">(</span>
                <span class="n">from_model</span><span class="o">=</span><span class="n">relation_field</span><span class="o">.</span><span class="n">get_source_model</span><span class="p">(),</span>
                <span class="n">relation_name</span><span class="o">=</span><span class="n">relation_field</span><span class="o">.</span><span class="n">get_relation_name</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">alias</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ormar.relations.AliasManager.reversed_aliases" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reversed_aliases</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns swapped key-value pairs from aliases where alias is the key.</p>
<p>:return: dictionary of prefix to relation
:rtype: Dict</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="ormar.relations.AliasManager.add_alias" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_alias</span><span class="p">(</span><span class="n">alias_key</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds alias to the dictionary of aliases under given key.</p>
<p>:param alias_key: key of relation to generate alias for
:type alias_key: str
:return: generated alias
:rtype: str</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/alias_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds alias to the dictionary of aliases under given key.</span>

<span class="sd">    :param alias_key: key of relation to generate alias for</span>
<span class="sd">    :type alias_key: str</span>
<span class="sd">    :return: generated alias</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alias</span> <span class="o">=</span> <span class="n">get_table_alias</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="p">[</span><span class="n">alias_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">alias</span>
    <span class="k">return</span> <span class="n">alias</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.AliasManager.add_relation_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_relation_type</span><span class="p">(</span><span class="n">source_model</span><span class="p">,</span> <span class="n">relation_name</span><span class="p">,</span> <span class="n">reverse_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Registers the relations defined in ormar models.
Given the relation it registers also the reverse side of this relation.</p>
<p>Used by both ForeignKey and ManyToMany relations.</p>
<p>Each relation is registered as Model name and relation name.
Each alias registered has to be unique.</p>
<p>Aliases are used to construct joins to assure proper links between tables.
That way you can link to the same target tables from multiple fields
on one model as well as from multiple different models in one join.</p>
<p>:param source_model: model with relation defined
:type source_model: source Model
:param relation_name: name of the relation to define
:type relation_name: str
:param reverse_name: name of related_name fo given relation for m2m relations
:type reverse_name: Optional[str]
:return: none
:rtype: None</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/alias_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_relation_type</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">source_model</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span>
    <span class="n">relation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">reverse_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Registers the relations defined in ormar models.</span>
<span class="sd">    Given the relation it registers also the reverse side of this relation.</span>

<span class="sd">    Used by both ForeignKey and ManyToMany relations.</span>

<span class="sd">    Each relation is registered as Model name and relation name.</span>
<span class="sd">    Each alias registered has to be unique.</span>

<span class="sd">    Aliases are used to construct joins to assure proper links between tables.</span>
<span class="sd">    That way you can link to the same target tables from multiple fields</span>
<span class="sd">    on one model as well as from multiple different models in one join.</span>

<span class="sd">    :param source_model: model with relation defined</span>
<span class="sd">    :type source_model: source Model</span>
<span class="sd">    :param relation_name: name of the relation to define</span>
<span class="sd">    :type relation_name: str</span>
<span class="sd">    :param reverse_name: name of related_name fo given relation for m2m relations</span>
<span class="sd">    :type reverse_name: Optional[str]</span>
<span class="sd">    :return: none</span>
<span class="sd">    :rtype: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parent_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">source_model</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">parent_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_alias</span><span class="p">(</span><span class="n">parent_key</span><span class="p">)</span>

    <span class="n">to_field</span> <span class="o">=</span> <span class="n">source_model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span>
    <span class="n">child_model</span> <span class="o">=</span> <span class="n">to_field</span><span class="o">.</span><span class="n">to</span>
    <span class="n">child_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">child_model</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">reverse_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">child_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_alias</span><span class="p">(</span><span class="n">child_key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.AliasManager.prefixed_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prefixed_columns</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a list of aliases sqlalchemy text clauses from
string alias and sqlalchemy.Table.</p>
<p>Optional list of fields to include can be passed to extract only those columns.
List has to have sqlalchemy names of columns (ormar aliases) not the ormar ones.</p>
<p>:param alias: alias of given table
:type alias: str
:param table: table from which fields should be aliased
:type table: sqlalchemy.Table
:param fields: fields to include
:type fields: Optional[List[str]]
:return: list of sqlalchemy text clauses with "column name as aliased name"
:rtype: List[text]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/alias_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">prefixed_columns</span><span class="p">(</span>
    <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Label</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a list of aliases sqlalchemy text clauses from</span>
<span class="sd">    string alias and sqlalchemy.Table.</span>

<span class="sd">    Optional list of fields to include can be passed to extract only those columns.</span>
<span class="sd">    List has to have sqlalchemy names of columns (ormar aliases) not the ormar ones.</span>

<span class="sd">    :param alias: alias of given table</span>
<span class="sd">    :type alias: str</span>
<span class="sd">    :param table: table from which fields should be aliased</span>
<span class="sd">    :type table: sqlalchemy.Table</span>
<span class="sd">    :param fields: fields to include</span>
<span class="sd">    :type fields: Optional[List[str]]</span>
<span class="sd">    :return: list of sqlalchemy text clauses with &quot;column name as aliased name&quot;</span>
<span class="sd">    :rtype: List[text]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alias</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">_&quot;</span> <span class="k">if</span> <span class="n">alias</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="n">aliased_fields</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alias</span><span class="si">}{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span> <span class="k">if</span> <span class="n">fields</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">all_columns</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">table</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span>
        <span class="k">else</span> <span class="p">[</span>
            <span class="n">col</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">fields</span> <span class="ow">or</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">aliased_fields</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">column</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alias</span><span class="si">}{</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">all_columns</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.AliasManager.prefixed_table_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prefixed_table_name</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates text clause with table name with aliased name.</p>
<p>:param alias: alias of given table
:type alias: str
:param table: table
:type table: sqlalchemy.Table
:return: sqlalchemy text clause as "table_name aliased_name"
:rtype: sqlalchemy text clause</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/alias_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prefixed_table_name</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">Table</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NamedFromClause</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates text clause with table name with aliased name.</span>

<span class="sd">    :param alias: alias of given table</span>
<span class="sd">    :type alias: str</span>
<span class="sd">    :param table: table</span>
<span class="sd">    :type table: sqlalchemy.Table</span>
<span class="sd">    :return: sqlalchemy text clause as &quot;table_name aliased_name&quot;</span>
<span class="sd">    :rtype: sqlalchemy text clause</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_alias</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">full_alias</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixed_tables</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">full_alias</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.AliasManager.resolve_relation_alias" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve_relation_alias</span><span class="p">(</span><span class="n">from_model</span><span class="p">,</span> <span class="n">relation_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Given model and relation name returns the alias for this relation.</p>
<p>:param from_model: model with relation defined
:type from_model: source Model
:param relation_name: name of the relation field
:type relation_name: str
:return: alias of the relation
:rtype: str</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/alias_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resolve_relation_alias</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">from_model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;ModelRow&quot;</span><span class="p">]],</span> <span class="n">relation_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given model and relation name returns the alias for this relation.</span>

<span class="sd">    :param from_model: model with relation defined</span>
<span class="sd">    :type from_model: source Model</span>
<span class="sd">    :param relation_name: name of the relation field</span>
<span class="sd">    :type relation_name: str</span>
<span class="sd">    :return: alias of the relation</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aliases_new</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">from_model</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">alias</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.AliasManager.resolve_relation_alias_after_complex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve_relation_alias_after_complex</span><span class="p">(</span><span class="n">source_model</span><span class="p">,</span> <span class="n">relation_str</span><span class="p">,</span> <span class="n">relation_field</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Given source model and relation string returns the alias for this complex
relation if it exists, otherwise fallback to normal relation from a relation
field definition.</p>
<p>:param relation_field: field with direct relation definition
:type relation_field: "ForeignKeyField"
:param source_model: model with query starts
:type source_model: source Model
:param relation_str: string with relation joins defined
:type relation_str: str
:return: alias of the relation
:rtype: str</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/alias_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resolve_relation_alias_after_complex</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">source_model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;ModelRow&quot;</span><span class="p">]],</span>
    <span class="n">relation_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">relation_field</span><span class="p">:</span> <span class="s2">&quot;ForeignKeyField&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given source model and relation string returns the alias for this complex</span>
<span class="sd">    relation if it exists, otherwise fallback to normal relation from a relation</span>
<span class="sd">    field definition.</span>

<span class="sd">    :param relation_field: field with direct relation definition</span>
<span class="sd">    :type relation_field: &quot;ForeignKeyField&quot;</span>
<span class="sd">    :param source_model: model with query starts</span>
<span class="sd">    :type source_model: source Model</span>
<span class="sd">    :param relation_str: string with relation joins defined</span>
<span class="sd">    :type relation_str: str</span>
<span class="sd">    :return: alias of the relation</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">relation_str</span> <span class="ow">and</span> <span class="s2">&quot;__&quot;</span> <span class="ow">in</span> <span class="n">relation_str</span><span class="p">:</span>
        <span class="n">alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_relation_alias</span><span class="p">(</span>
            <span class="n">from_model</span><span class="o">=</span><span class="n">source_model</span><span class="p">,</span> <span class="n">relation_name</span><span class="o">=</span><span class="n">relation_str</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">alias</span><span class="p">:</span>
        <span class="n">alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_relation_alias</span><span class="p">(</span>
            <span class="n">from_model</span><span class="o">=</span><span class="n">relation_field</span><span class="o">.</span><span class="n">get_source_model</span><span class="p">(),</span>
            <span class="n">relation_name</span><span class="o">=</span><span class="n">relation_field</span><span class="o">.</span><span class="n">get_relation_name</span><span class="p">(),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">alias</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ormar.relations.Relation" class="doc doc-heading">
            <code>Relation</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="ormar.models.T">T</span>]</code></p>



        <p>Keeps related Models and handles adding/removing of the children.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>ormar/relations/relation.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Relation</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Keeps related Models and handles adding/removing of the children.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">manager</span><span class="p">:</span> <span class="s2">&quot;RelationsManager&quot;</span><span class="p">,</span>
        <span class="n">type_</span><span class="p">:</span> <span class="n">RelationType</span><span class="p">,</span>
        <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">to</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
        <span class="n">through</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the Relation and keep the related models either as instances of</span>
<span class="sd">        passed Model, or as a RelationProxy which is basically a list of models with</span>
<span class="sd">        some special behavior, as it exposes QuerySetProxy and allows querying the</span>
<span class="sd">        related models already pre filtered by parent model.</span>

<span class="sd">        :param manager: reference to relation manager</span>
<span class="sd">        :type manager: RelationsManager</span>
<span class="sd">        :param type_: type of the relation</span>
<span class="sd">        :type type_: RelationType</span>
<span class="sd">        :param field_name: name of the relation field</span>
<span class="sd">        :type field_name: str</span>
<span class="sd">        :param to: model to which relation leads to</span>
<span class="sd">        :type to: Type[Model]</span>
<span class="sd">        :param through: model through which relation goes for m2m relations</span>
<span class="sd">        :type through: Type[Model]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">owner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">:</span> <span class="n">RelationType</span> <span class="o">=</span> <span class="n">type_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_to_remove</span><span class="p">:</span> <span class="n">Set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_through</span> <span class="o">=</span> <span class="n">through</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RelationProxy</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">RelationProxy</span><span class="p">(</span><span class="n">relation</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">to</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="n">field_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">type_</span> <span class="ow">in</span> <span class="p">(</span><span class="n">RelationType</span><span class="o">.</span><span class="n">REVERSE</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">MULTIPLE</span><span class="p">)</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="p">(</span><span class="n">RelationType</span><span class="o">.</span><span class="n">PRIMARY</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">THROUGH</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">related_models</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;RelationProxy&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="p">)</span>
            <span class="n">related_models</span><span class="o">.</span><span class="n">_clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">through</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">RelationshipInstanceError</span><span class="p">(</span><span class="s2">&quot;Relation does not have through model!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_through</span>

    <span class="k">def</span> <span class="nf">_clean_related</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes dead weakrefs from RelationProxy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cleaned_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_remove</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="o">=</span> <span class="n">RelationProxy</span><span class="p">(</span>
            <span class="n">relation</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
            <span class="n">to</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">,</span>
            <span class="n">field_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">field_name</span><span class="p">,</span>
            <span class="n">data_</span><span class="o">=</span><span class="n">cleaned_data</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">relation_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cleaned_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_to_remove</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_find_existing</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find child model in RelationProxy if exists.</span>

<span class="sd">        :param child: child model to find</span>
<span class="sd">        :type child: Model</span>
<span class="sd">        :return: index of child in RelationProxy</span>
<span class="sd">        :rtype: Optional[ind]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="p">,</span> <span class="n">RelationProxy</span><span class="p">):</span>  <span class="c1"># pragma nocover</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot find existing models in parent relation type&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># We need to clear the weakrefs that don&#39;t point to anything anymore</span>
            <span class="c1"># There&#39;s an assumption here that if some of the related models</span>
            <span class="c1"># went out of scope, then they all did, so we can just check the first one</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="fm">__repr__</span><span class="o">.</span><span class="vm">__self__</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ReferenceError</span><span class="p">:</span>
                <span class="n">missing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="o">.</span><span class="n">_get_list_of_missing_weakrefs</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_to_remove</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds child Model to relation, either sets child as related model or adds</span>
<span class="sd">        it to the list in RelationProxy depending on relation type.</span>

<span class="sd">        :param child: model to add to relation</span>
<span class="sd">        :type child: Model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relation_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="p">(</span><span class="n">RelationType</span><span class="o">.</span><span class="n">PRIMARY</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">THROUGH</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="o">=</span> <span class="n">child</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_existing</span><span class="p">(</span><span class="n">child</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                <span class="n">rel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">relation_name</span><span class="p">,</span> <span class="p">[])</span>
                <span class="n">rel</span> <span class="o">=</span> <span class="n">rel</span> <span class="ow">or</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rel</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">rel</span> <span class="o">=</span> <span class="p">[</span><span class="n">rel</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_populate_owner_side_dict</span><span class="p">(</span><span class="n">rel</span><span class="o">=</span><span class="n">rel</span><span class="p">,</span> <span class="n">child</span><span class="o">=</span><span class="n">child</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel</span>

    <span class="k">def</span> <span class="nf">_populate_owner_side_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">child</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rel</span><span class="p">:</span>
                <span class="n">rel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ReferenceError</span><span class="p">:</span>
            <span class="n">rel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">rel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes child Model from relation, either sets None as related model or removes</span>
<span class="sd">        it from the list in RelationProxy depending on relation type.</span>

<span class="sd">        :param child: model to remove from relation</span>
<span class="sd">        :type child: Model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relation_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">PRIMARY</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="o">==</span> <span class="n">child</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_existing</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">][</span><span class="n">position</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="s2">&quot;Model&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the related model or models from RelationProxy.</span>

<span class="sd">        :return: related model/models if set</span>
<span class="sd">        :rtype: Optional[Union[List[Model], Model]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_remove</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_clean_related</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_remove</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_clean_related</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="ormar.relations.Relation.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">through</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the Relation and keep the related models either as instances of
passed Model, or as a RelationProxy which is basically a list of models with
some special behavior, as it exposes QuerySetProxy and allows querying the
related models already pre filtered by parent model.</p>
<p>:param manager: reference to relation manager
:type manager: RelationsManager
:param type_: type of the relation
:type type_: RelationType
:param field_name: name of the relation field
:type field_name: str
:param to: model to which relation leads to
:type to: Type[Model]
:param through: model through which relation goes for m2m relations
:type through: Type[Model]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">manager</span><span class="p">:</span> <span class="s2">&quot;RelationsManager&quot;</span><span class="p">,</span>
    <span class="n">type_</span><span class="p">:</span> <span class="n">RelationType</span><span class="p">,</span>
    <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
    <span class="n">through</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the Relation and keep the related models either as instances of</span>
<span class="sd">    passed Model, or as a RelationProxy which is basically a list of models with</span>
<span class="sd">    some special behavior, as it exposes QuerySetProxy and allows querying the</span>
<span class="sd">    related models already pre filtered by parent model.</span>

<span class="sd">    :param manager: reference to relation manager</span>
<span class="sd">    :type manager: RelationsManager</span>
<span class="sd">    :param type_: type of the relation</span>
<span class="sd">    :type type_: RelationType</span>
<span class="sd">    :param field_name: name of the relation field</span>
<span class="sd">    :type field_name: str</span>
<span class="sd">    :param to: model to which relation leads to</span>
<span class="sd">    :type to: Type[Model]</span>
<span class="sd">    :param through: model through which relation goes for m2m relations</span>
<span class="sd">    :type through: Type[Model]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">manager</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">owner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">:</span> <span class="n">RelationType</span> <span class="o">=</span> <span class="n">type_</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_to_remove</span><span class="p">:</span> <span class="n">Set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_through</span> <span class="o">=</span> <span class="n">through</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RelationProxy</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">RelationProxy</span><span class="p">(</span><span class="n">relation</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">to</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">type_</span> <span class="ow">in</span> <span class="p">(</span><span class="n">RelationType</span><span class="o">.</span><span class="n">REVERSE</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">MULTIPLE</span><span class="p">)</span>
        <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.Relation.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">child</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds child Model to relation, either sets child as related model or adds
it to the list in RelationProxy depending on relation type.</p>
<p>:param child: model to add to relation
:type child: Model</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds child Model to relation, either sets child as related model or adds</span>
<span class="sd">    it to the list in RelationProxy depending on relation type.</span>

<span class="sd">    :param child: model to add to relation</span>
<span class="sd">    :type child: Model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">relation_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_name</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="p">(</span><span class="n">RelationType</span><span class="o">.</span><span class="n">PRIMARY</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">THROUGH</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="o">=</span> <span class="n">child</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_existing</span><span class="p">(</span><span class="n">child</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="n">rel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">relation_name</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">rel</span> <span class="o">=</span> <span class="n">rel</span> <span class="ow">or</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rel</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">rel</span> <span class="o">=</span> <span class="p">[</span><span class="n">rel</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_owner_side_dict</span><span class="p">(</span><span class="n">rel</span><span class="o">=</span><span class="n">rel</span><span class="p">,</span> <span class="n">child</span><span class="o">=</span><span class="n">child</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.Relation.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the related model or models from RelationProxy.</p>
<p>:return: related model/models if set
:rtype: Optional[Union[List[Model], Model]]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="s2">&quot;Model&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the related model or models from RelationProxy.</span>

<span class="sd">    :return: related model/models if set</span>
<span class="sd">    :rtype: Optional[Union[List[Model], Model]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_remove</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clean_related</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.Relation.remove" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Removes child Model from relation, either sets None as related model or removes
it from the list in RelationProxy depending on relation type.</p>
<p>:param child: model to remove from relation
:type child: Model</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes child Model from relation, either sets None as related model or removes</span>
<span class="sd">    it from the list in RelationProxy depending on relation type.</span>

<span class="sd">    :param child: model to remove from relation</span>
<span class="sd">    :type child: Model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">relation_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_name</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">PRIMARY</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="o">==</span> <span class="n">child</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_existing</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">related_models</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">relation_name</span><span class="p">][</span><span class="n">position</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ormar.relations.RelationType" class="doc doc-heading">
            <code>RelationType</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>



        <p>Different types of relations supported by ormar:</p>
<ul>
<li>ForeignKey = PRIMARY</li>
<li>reverse ForeignKey = REVERSE</li>
<li>ManyToMany = MULTIPLE</li>
</ul>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>ormar/relations/relation.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RelationType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Different types of relations supported by ormar:</span>

<span class="sd">    *  ForeignKey = PRIMARY</span>
<span class="sd">    *  reverse ForeignKey = REVERSE</span>
<span class="sd">    *  ManyToMany = MULTIPLE</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PRIMARY</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">REVERSE</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">MULTIPLE</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">THROUGH</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ormar.relations.RelationsManager" class="doc doc-heading">
            <code>RelationsManager</code>


</h2>


    <div class="doc doc-contents ">



        <p>Manages relations on a Model, each Model has it's own instance.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>ormar/relations/relation_manager.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RelationsManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manages relations on a Model, each Model has it&#39;s own instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">related_fields</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="s2">&quot;ForeignKeyField&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">proxy</span><span class="p">(</span><span class="n">owner</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_related_fields</span> <span class="o">=</span> <span class="n">related_fields</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_related_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_related_fields</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_relations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Relation</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_related_fields</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_relation</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if relation with given name is already registered.</span>

<span class="sd">        :param item: name of attribute</span>
<span class="sd">        :type item: str</span>
<span class="sd">        :return: result of the check</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_related_names</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">relation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">relation</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the related model/models if relation is set.</span>
<span class="sd">        Actual call is delegated to Relation instance registered under relation name.</span>

<span class="sd">        :param name: name of the relation</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :return: related model or list of related models if set</span>
<span class="sd">        :rtype: Optional[Union[Model, List[Model]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">relation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># pragma nocover</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="s2">&quot;ForeignKeyField&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds relation on both sides -&gt; meaning on both child and parent models.</span>
<span class="sd">        One side of the relation is always weakref proxy to avoid circular refs.</span>

<span class="sd">        Based on the side from which relation is added and relation name actual names</span>
<span class="sd">        of parent and child relations are established. The related models are registered</span>
<span class="sd">        on both ends.</span>

<span class="sd">        :param parent: parent model on which relation should be registered</span>
<span class="sd">        :type parent: Model</span>
<span class="sd">        :param child: child model to register</span>
<span class="sd">        :type child: Model</span>
<span class="sd">        :param field: field with relation definition</span>
<span class="sd">        :type field: ForeignKeyField</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parent</span><span class="p">,</span> <span class="n">child</span><span class="p">,</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">to_name</span> <span class="o">=</span> <span class="n">get_relations_sides_and_names</span><span class="p">(</span>
            <span class="n">field</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">child</span>
        <span class="p">)</span>

        <span class="c1"># print(&#39;adding parent&#39;, parent.get_name(), child.get_name(), child_name)</span>
        <span class="n">parent_relation</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_orm</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">child_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent_relation</span><span class="p">:</span>
            <span class="n">parent_relation</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="c1"># print(&#39;adding child&#39;, child.get_name(), parent.get_name(), to_name)</span>
        <span class="n">child_relation</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">_orm</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">to_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">child_relation</span><span class="p">:</span>
            <span class="n">child_relation</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes given child from relation with given name.</span>
<span class="sd">        Since you can have many relations between two models you need to pass a name</span>
<span class="sd">        of relation from which you want to remove the child.</span>

<span class="sd">        :param name: name of the relation</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param child: child to remove from relation</span>
<span class="sd">        :type child: Union[Model, Type[Model]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">relation</span><span class="p">:</span>
            <span class="n">relation</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">remove_parent</span><span class="p">(</span>
        <span class="n">item</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">]],</span> <span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes given parent from relation with given name.</span>
<span class="sd">        Since you can have many relations between two models you need to pass a name</span>
<span class="sd">        of relation from which you want to remove the parent.</span>

<span class="sd">        :param item: model with parent registered</span>
<span class="sd">        :type item: Union[Model, Type[Model]]</span>
<span class="sd">        :param parent: parent Model</span>
<span class="sd">        :type parent: Model</span>
<span class="sd">        :param name: name of the relation</span>
<span class="sd">        :type name: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relation_name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_name</span><span class="p">()</span>
        <span class="n">item</span><span class="o">.</span><span class="n">_orm</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">_orm</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">relation_name</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Relation</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the actual relation and not the related model(s).</span>

<span class="sd">        :param name: name of the relation</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :return: Relation instance</span>
<span class="sd">        :rtype: ormar.relations.relation.Relation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">relation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">relation</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_get_relation_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="s2">&quot;BaseField&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RelationType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns type of the relation declared on a field.</span>

<span class="sd">        :param field: field with relation declaration</span>
<span class="sd">        :type field: BaseField</span>
<span class="sd">        :return: type of the relation defined on field</span>
<span class="sd">        :rtype: RelationType</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">is_multi</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">MULTIPLE</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">is_through</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">THROUGH</span>
        <span class="k">return</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">PRIMARY</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">virtual</span> <span class="k">else</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">REVERSE</span>

    <span class="k">def</span> <span class="nf">_add_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="s2">&quot;BaseField&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers relation in the manager.</span>
<span class="sd">        Adds Relation instance under field.name.</span>

<span class="sd">        :param field: field with relation declaration</span>
<span class="sd">        :type field: BaseField</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_relations</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relation</span><span class="p">(</span>
            <span class="n">manager</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_relation_type</span><span class="p">(</span><span class="n">field</span><span class="p">),</span>
            <span class="n">field_name</span><span class="o">=</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">to</span><span class="o">=</span><span class="n">field</span><span class="o">.</span><span class="n">to</span><span class="p">,</span>
            <span class="n">through</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s2">&quot;through&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="ormar.relations.RelationsManager.__contains__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks if relation with given name is already registered.</p>
<p>:param item: name of attribute
:type item: str
:return: result of the check
:rtype: bool</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if relation with given name is already registered.</span>

<span class="sd">    :param item: name of attribute</span>
<span class="sd">    :type item: str</span>
<span class="sd">    :return: result of the check</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_related_names</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.RelationsManager.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">child</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Adds relation on both sides -&gt; meaning on both child and parent models.
One side of the relation is always weakref proxy to avoid circular refs.</p>
<p>Based on the side from which relation is added and relation name actual names
of parent and child relations are established. The related models are registered
on both ends.</p>
<p>:param parent: parent model on which relation should be registered
:type parent: Model
:param child: child model to register
:type child: Model
:param field: field with relation definition
:type field: ForeignKeyField</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="s2">&quot;ForeignKeyField&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds relation on both sides -&gt; meaning on both child and parent models.</span>
<span class="sd">    One side of the relation is always weakref proxy to avoid circular refs.</span>

<span class="sd">    Based on the side from which relation is added and relation name actual names</span>
<span class="sd">    of parent and child relations are established. The related models are registered</span>
<span class="sd">    on both ends.</span>

<span class="sd">    :param parent: parent model on which relation should be registered</span>
<span class="sd">    :type parent: Model</span>
<span class="sd">    :param child: child model to register</span>
<span class="sd">    :type child: Model</span>
<span class="sd">    :param field: field with relation definition</span>
<span class="sd">    :type field: ForeignKeyField</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parent</span><span class="p">,</span> <span class="n">child</span><span class="p">,</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">to_name</span> <span class="o">=</span> <span class="n">get_relations_sides_and_names</span><span class="p">(</span>
        <span class="n">field</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">child</span>
    <span class="p">)</span>

    <span class="c1"># print(&#39;adding parent&#39;, parent.get_name(), child.get_name(), child_name)</span>
    <span class="n">parent_relation</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_orm</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">child_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">parent_relation</span><span class="p">:</span>
        <span class="n">parent_relation</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># print(&#39;adding child&#39;, child.get_name(), parent.get_name(), to_name)</span>
    <span class="n">child_relation</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">_orm</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">to_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">child_relation</span><span class="p">:</span>
        <span class="n">child_relation</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.RelationsManager.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the related model/models if relation is set.
Actual call is delegated to Relation instance registered under relation name.</p>
<p>:param name: name of the relation
:type name: str
:return: related model or list of related models if set
:rtype: Optional[Union[Model, List[Model]]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the related model/models if relation is set.</span>
<span class="sd">    Actual call is delegated to Relation instance registered under relation name.</span>

<span class="sd">    :param name: name of the relation</span>
<span class="sd">    :type name: str</span>
<span class="sd">    :return: related model or list of related models if set</span>
<span class="sd">    :rtype: Optional[Union[Model, List[Model]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">relation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># pragma nocover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.RelationsManager.remove" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Removes given child from relation with given name.
Since you can have many relations between two models you need to pass a name
of relation from which you want to remove the child.</p>
<p>:param name: name of the relation
:type name: str
:param child: child to remove from relation
:type child: Union[Model, Type[Model]]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes given child from relation with given name.</span>
<span class="sd">    Since you can have many relations between two models you need to pass a name</span>
<span class="sd">    of relation from which you want to remove the child.</span>

<span class="sd">    :param name: name of the relation</span>
<span class="sd">    :type name: str</span>
<span class="sd">    :param child: child to remove from relation</span>
<span class="sd">    :type child: Union[Model, Type[Model]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">relation</span><span class="p">:</span>
        <span class="n">relation</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.relations.RelationsManager.remove_parent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_parent</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Removes given parent from relation with given name.
Since you can have many relations between two models you need to pass a name
of relation from which you want to remove the parent.</p>
<p>:param item: model with parent registered
:type item: Union[Model, Type[Model]]
:param parent: parent Model
:type parent: Model
:param name: name of the relation
:type name: str</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/relation_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">remove_parent</span><span class="p">(</span>
    <span class="n">item</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;NewBaseModel&quot;</span><span class="p">]],</span> <span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes given parent from relation with given name.</span>
<span class="sd">    Since you can have many relations between two models you need to pass a name</span>
<span class="sd">    of relation from which you want to remove the parent.</span>

<span class="sd">    :param item: model with parent registered</span>
<span class="sd">    :type item: Union[Model, Type[Model]]</span>
<span class="sd">    :param parent: parent Model</span>
<span class="sd">    :type parent: Model</span>
<span class="sd">    :param name: name of the relation</span>
<span class="sd">    :type name: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">relation_name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_name</span><span class="p">()</span>
    <span class="n">item</span><span class="o">.</span><span class="n">_orm</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">_orm</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">relation_name</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="ormar.relations.get_relations_sides_and_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_relations_sides_and_names</span><span class="p">(</span><span class="n">to_field</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Determines the names of child and parent relations names, as well as
changes one of the sides of the relation into weakref.proxy to model.</p>
<p>:param to_field: field with relation definition
:type to_field: ForeignKeyField
:param parent: parent model
:type parent: Model
:param child: child model
:type child: Model
:return: parent, child, child_name, to_name
:rtype: Tuple["Model", "Model", str, str]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>ormar/relations/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_relations_sides_and_names</span><span class="p">(</span>
    <span class="n">to_field</span><span class="p">:</span> <span class="n">ForeignKeyField</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines the names of child and parent relations names, as well as</span>
<span class="sd">    changes one of the sides of the relation into weakref.proxy to model.</span>

<span class="sd">    :param to_field: field with relation definition</span>
<span class="sd">    :type to_field: ForeignKeyField</span>
<span class="sd">    :param parent: parent model</span>
<span class="sd">    :type parent: Model</span>
<span class="sd">    :param child: child model</span>
<span class="sd">    :type child: Model</span>
<span class="sd">    :return: parent, child, child_name, to_name</span>
<span class="sd">    :rtype: Tuple[&quot;Model&quot;, &quot;Model&quot;, str, str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_name</span> <span class="o">=</span> <span class="n">to_field</span><span class="o">.</span><span class="n">name</span>
    <span class="n">child_name</span> <span class="o">=</span> <span class="n">to_field</span><span class="o">.</span><span class="n">get_related_name</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">to_field</span><span class="o">.</span><span class="n">virtual</span><span class="p">:</span>
        <span class="n">child_name</span><span class="p">,</span> <span class="n">to_name</span> <span class="o">=</span> <span class="n">to_name</span><span class="p">,</span> <span class="n">child_name</span>
        <span class="n">child</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="p">,</span> <span class="n">proxy</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">proxy</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parent</span><span class="p">,</span> <span class="n">child</span><span class="p">,</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">to_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
    
  </body>
</html>