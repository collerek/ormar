
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A simple async ORM with fastapi in mind and pydantic validation.">
      
      
      
        <link rel="canonical" href="https://collerek.github.io/ormar/latest/api/models/mixins/">
      
      
        <link rel="prev" href="../metaclass/">
      
      
        <link rel="next" href="alias_mixin/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.47">
    
    
      
        <title>mixins - ormar</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-72514911-3"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-72514911-3",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-72514911-3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ormar.models.mixins" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ormar" class="md-header__button md-logo" aria-label="ormar" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ormar
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              mixins
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/collerek/ormar" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    collerek/ormar
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ormar" class="md-nav__button md-logo" aria-label="ormar" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ormar
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/collerek/ormar" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    collerek/ormar
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Definition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/inheritance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inheritance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/migrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/internals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internals
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Fields
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Fields
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fields/common-parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fields/field-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fields/pydantic-fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic only fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fields/encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields encryption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Relations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Relations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../relations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relation types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../relations/foreign-key/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForeignKey
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../relations/many-to-many/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ManyToMany
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../relations/postponed-annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postponed annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../relations/queryset-proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QuerySetProxy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../queries/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Queries
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Queries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insert data into database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/read/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read data from database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update data in database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete data from database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/joins-and-subqueries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Joins and subqueries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/filter-and-sort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filtering and sorting data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/select-columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Selecting subset of columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/pagination-and-rows-number/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pagination and rows number
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/aggregations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aggregation functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../queries/raw-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Return raw data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../signals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Signals
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../transactions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transactions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Use with Fastapi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Use with Fastapi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fastapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fastapi/response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using ormar in responses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fastapi/requests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using ormar in requests
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use with mypy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration to v 0.20
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyCharm plugin
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../releases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" checked>
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Api (BETA)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Api (BETA)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ormar
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1" id="__nav_15_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_15_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15_1">
            <span class="md-nav__icon md-icon"></span>
            ormar
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../decorators/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    decorators
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_1" id="__nav_15_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_1">
            <span class="md-nav__icon md-icon"></span>
            decorators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decorators/signals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signals
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exceptions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../fields/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    fields
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_3" id="__nav_15_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_3">
            <span class="md-nav__icon md-icon"></span>
            fields
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    constraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/foreign_key/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foreign_key
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/many_to_many/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    many_to_many
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/model_fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/parsers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parsers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/referential_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    referential_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/sqlalchemy_encrypted/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sqlalchemy_encrypted
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/sqlalchemy_uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sqlalchemy_uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fields/through_field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    through_field
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    models
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_4" id="__nav_15_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15_1_4">
            <span class="md-nav__icon md-icon"></span>
            models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_4_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../descriptors/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    descriptors
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_4_1" id="__nav_15_1_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_4_1">
            <span class="md-nav__icon md-icon"></span>
            descriptors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../descriptors/descriptors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    descriptors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../excludable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    excludable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../helpers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    helpers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_4_3" id="__nav_15_1_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_4_3">
            <span class="md-nav__icon md-icon"></span>
            helpers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/pydantic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pydantic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/related_names_validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    related_names_validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/relations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    relations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/sqlalchemy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sqlalchemy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    validation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metaclass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metaclass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_4_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  <span class="md-ellipsis">
    mixins
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_15_1_4_5" id="__nav_15_1_4_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_4_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15_1_4_5">
            <span class="md-nav__icon md-icon"></span>
            mixins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="alias_mixin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    alias_mixin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="excludable_mixin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    excludable_mixin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="merge_mixin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    merge_mixin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pydantic_mixin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pydantic_mixin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="relation_mixin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    relation_mixin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="save_mixin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    save_mixin
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model_row/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_row
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modelproxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    modelproxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../newbasemodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    newbasemodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ormar_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ormar_config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick_access_views/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quick_access_views
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../traversible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traversible
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../protocols/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    protocols
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_5" id="__nav_15_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_5">
            <span class="md-nav__icon md-icon"></span>
            protocols
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/queryset_protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    queryset_protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/relation_protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    relation_protocol
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../queryset/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    queryset
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_6" id="__nav_15_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_6">
            <span class="md-nav__icon md-icon"></span>
            queryset
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_6_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../queryset/actions/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    actions
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_6_1" id="__nav_15_1_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_6_1">
            <span class="md-nav__icon md-icon"></span>
            actions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/actions/filter_action/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filter_action
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/actions/order_action/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    order_action
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/actions/query_action/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    query_action
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/actions/select_action/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    select_action
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/clause/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clause
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/field_accessor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    field_accessor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/join/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    join
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_6_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../queryset/queries/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    queries
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_6_5" id="__nav_15_1_6_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_15_1_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_6_5">
            <span class="md-nav__icon md-icon"></span>
            queries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/queries/filter_query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filter_query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/queries/limit_query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit_query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/queries/offset_query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    offset_query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/queries/order_query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    order_query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/queries/prefetch_query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prefetch_query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/queries/query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    query
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/queryset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    queryset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/reverse_alias_resolver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reverse_alias_resolver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queryset/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../relations/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    relations
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_7" id="__nav_15_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_7">
            <span class="md-nav__icon md-icon"></span>
            relations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/alias_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    alias_manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/querysetproxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    querysetproxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/relation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    relation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/relation_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    relation_manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/relation_proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    relation_proxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relations/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_1_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../signals/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    signals
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15_1_8" id="__nav_15_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_15_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_1_8">
            <span class="md-nav__icon md-icon"></span>
            signals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../signals/signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signal
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    warnings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ormar.models.mixins" class="md-nav__link">
    <span class="md-ellipsis">
      mixins
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.models.mixins.AliasMixin" class="md-nav__link">
    <span class="md-ellipsis">
      AliasMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AliasMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.AliasMixin.get_column_alias" class="md-nav__link">
    <span class="md-ellipsis">
      get_column_alias
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.AliasMixin.get_column_name_from_alias" class="md-nav__link">
    <span class="md-ellipsis">
      get_column_name_from_alias
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.AliasMixin.translate_aliases_to_columns" class="md-nav__link">
    <span class="md-ellipsis">
      translate_aliases_to_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.AliasMixin.translate_columns_to_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      translate_columns_to_aliases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.models.mixins.ExcludableMixin" class="md-nav__link">
    <span class="md-ellipsis">
      ExcludableMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExcludableMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.ExcludableMixin.get_child" class="md-nav__link">
    <span class="md-ellipsis">
      get_child
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.ExcludableMixin.get_names_to_exclude" class="md-nav__link">
    <span class="md-ellipsis">
      get_names_to_exclude
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.ExcludableMixin.own_table_columns" class="md-nav__link">
    <span class="md-ellipsis">
      own_table_columns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.models.mixins.MergeModelMixin" class="md-nav__link">
    <span class="md-ellipsis">
      MergeModelMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MergeModelMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.MergeModelMixin.merge_instances_list" class="md-nav__link">
    <span class="md-ellipsis">
      merge_instances_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.MergeModelMixin.merge_two_instances" class="md-nav__link">
    <span class="md-ellipsis">
      merge_two_instances
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.models.mixins.PydanticMixin" class="md-nav__link">
    <span class="md-ellipsis">
      PydanticMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PydanticMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.PydanticMixin.copy_selected_validators_type" class="md-nav__link">
    <span class="md-ellipsis">
      copy_selected_validators_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.PydanticMixin.get_pydantic" class="md-nav__link">
    <span class="md-ellipsis">
      get_pydantic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin" class="md-nav__link">
    <span class="md-ellipsis">
      SavePrepareMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SavePrepareMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin.dump_all_json_fields_to_str" class="md-nav__link">
    <span class="md-ellipsis">
      dump_all_json_fields_to_str
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin.parse_non_db_fields" class="md-nav__link">
    <span class="md-ellipsis">
      parse_non_db_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin.populate_default_values" class="md-nav__link">
    <span class="md-ellipsis">
      populate_default_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin.prepare_model_to_save" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_model_to_save
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin.prepare_model_to_update" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_model_to_update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin.reconvert_str_to_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      reconvert_str_to_bytes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin.substitute_models_with_pks" class="md-nav__link">
    <span class="md-ellipsis">
      substitute_models_with_pks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ormar.models.mixins.SavePrepareMixin.validate_enums" class="md-nav__link">
    <span class="md-ellipsis">
      validate_enums
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>mixins</h1>

<div class="doc doc-object doc-module">



<a id="ormar.models.mixins"></a>
    <div class="doc doc-contents first">

      <p>Package contains functionalities divided by features.
All mixins are combined into ModelTableProxy which is one of the parents of Model.
The split into mixins was done to ease the maintainability of the proxy class, as
it became quite complicated over time.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="ormar.models.mixins.AliasMixin" class="doc doc-heading">
            <code>AliasMixin</code>


</h2>


    <div class="doc doc-contents ">


      <p>Used to translate field names into database column names.</p>

              <details class="quote">
                <summary>Source code in <code>ormar/models/mixins/alias_mixin.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AliasMixin</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to translate field names into database column names.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="kn">from</span> <span class="nn">ormar.models.ormar_config</span> <span class="kn">import</span> <span class="n">OrmarConfig</span>

        <span class="n">ormar_config</span><span class="p">:</span> <span class="n">OrmarConfig</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_column_alias</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns db alias (column name in db) for given ormar field.</span>
<span class="sd">        For fields without alias field name is returned.</span>
<span class="sd">        :param field_name: name of the field to get alias from</span>
<span class="sd">        :type field_name: str</span>
<span class="sd">        :return: alias (db name) if set, otherwise passed name</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()</span> <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">field_name</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_column_name_from_alias</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ormar field name for given db alias (column name in db).</span>
<span class="sd">        If field do not have alias it&#39;s returned as is.</span>
<span class="sd">        :param alias:</span>
<span class="sd">        :type alias: str</span>
<span class="sd">        :return: field name if set, otherwise passed alias (db name)</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()</span> <span class="o">==</span> <span class="n">alias</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">field_name</span>
        <span class="k">return</span> <span class="n">alias</span>  <span class="c1"># if not found it&#39;s not an alias but actual name</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">translate_columns_to_aliases</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates dictionary of model fields changing field names into aliases.</span>
<span class="sd">        If field has no alias the field name remains intact.</span>
<span class="sd">        Only fields present in the dictionary are translated.</span>
<span class="sd">        :param new_kwargs: dict with fields names and their values</span>
<span class="sd">        :type new_kwargs: Dict</span>
<span class="sd">        :return: dict with aliases and their values</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">new_kwargs</span><span class="p">:</span>
                <span class="n">new_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()]</span> <span class="o">=</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">translate_aliases_to_columns</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates dictionary of model fields changing aliases into field names.</span>
<span class="sd">        If field has no alias the alias is already a field name.</span>
<span class="sd">        Only fields present in the dictionary are translated.</span>
<span class="sd">        :param new_kwargs: dict with aliases and their values</span>
<span class="sd">        :type new_kwargs: Dict</span>
<span class="sd">        :return: dict with fields names and their values</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()</span> <span class="ow">in</span> <span class="n">new_kwargs</span><span class="p">:</span>
                <span class="n">new_kwargs</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.AliasMixin.get_column_alias" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_column_alias</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Returns db alias (column name in db) for given ormar field.
For fields without alias field name is returned.
:param field_name: name of the field to get alias from
:type field_name: str
:return: alias (db name) if set, otherwise passed name
:rtype: str</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/alias_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_column_alias</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns db alias (column name in db) for given ormar field.</span>
<span class="sd">    For fields without alias field name is returned.</span>
<span class="sd">    :param field_name: name of the field to get alias from</span>
<span class="sd">    :type field_name: str</span>
<span class="sd">    :return: alias (db name) if set, otherwise passed name</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()</span> <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">field_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.AliasMixin.get_column_name_from_alias" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_column_name_from_alias</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Returns ormar field name for given db alias (column name in db).
If field do not have alias it's returned as is.
:param alias:
:type alias: str
:return: field name if set, otherwise passed alias (db name)
:rtype: str</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/alias_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_column_name_from_alias</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns ormar field name for given db alias (column name in db).</span>
<span class="sd">    If field do not have alias it&#39;s returned as is.</span>
<span class="sd">    :param alias:</span>
<span class="sd">    :type alias: str</span>
<span class="sd">    :return: field name if set, otherwise passed alias (db name)</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()</span> <span class="o">==</span> <span class="n">alias</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">field_name</span>
    <span class="k">return</span> <span class="n">alias</span>  <span class="c1"># if not found it&#39;s not an alias but actual name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.AliasMixin.translate_aliases_to_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">translate_aliases_to_columns</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Translates dictionary of model fields changing aliases into field names.
If field has no alias the alias is already a field name.
Only fields present in the dictionary are translated.
:param new_kwargs: dict with aliases and their values
:type new_kwargs: Dict
:return: dict with fields names and their values
:rtype: Dict</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/alias_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">translate_aliases_to_columns</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Translates dictionary of model fields changing aliases into field names.</span>
<span class="sd">    If field has no alias the alias is already a field name.</span>
<span class="sd">    Only fields present in the dictionary are translated.</span>
<span class="sd">    :param new_kwargs: dict with aliases and their values</span>
<span class="sd">    :type new_kwargs: Dict</span>
<span class="sd">    :return: dict with fields names and their values</span>
<span class="sd">    :rtype: Dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()</span> <span class="ow">in</span> <span class="n">new_kwargs</span><span class="p">:</span>
            <span class="n">new_kwargs</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">new_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.AliasMixin.translate_columns_to_aliases" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">translate_columns_to_aliases</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Translates dictionary of model fields changing field names into aliases.
If field has no alias the field name remains intact.
Only fields present in the dictionary are translated.
:param new_kwargs: dict with fields names and their values
:type new_kwargs: Dict
:return: dict with aliases and their values
:rtype: Dict</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/alias_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">translate_columns_to_aliases</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Translates dictionary of model fields changing field names into aliases.</span>
<span class="sd">    If field has no alias the field name remains intact.</span>
<span class="sd">    Only fields present in the dictionary are translated.</span>
<span class="sd">    :param new_kwargs: dict with fields names and their values</span>
<span class="sd">    :type new_kwargs: Dict</span>
<span class="sd">    :return: dict with aliases and their values</span>
<span class="sd">    :rtype: Dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">new_kwargs</span><span class="p">:</span>
            <span class="n">new_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">get_alias</span><span class="p">()]</span> <span class="o">=</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ormar.models.mixins.ExcludableMixin" class="doc doc-heading">
            <code>ExcludableMixin</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ormar.models.mixins.relation_mixin.RelationMixin" href="relation_mixin/#ormar.models.mixins.relation_mixin.RelationMixin">RelationMixin</a></code></p>


      <p>Used to include/exclude given set of fields on models during load and dict() calls.</p>

              <details class="quote">
                <summary>Source code in <code>ormar/models/mixins/excludable_mixin.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ExcludableMixin</span><span class="p">(</span><span class="n">RelationMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to include/exclude given set of fields on models during load and dict() calls.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="kn">from</span> <span class="nn">ormar</span> <span class="kn">import</span> <span class="n">Model</span>
        <span class="kn">from</span> <span class="nn">ormar.models</span> <span class="kn">import</span> <span class="n">ModelRow</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_child</span><span class="p">(</span>
        <span class="n">items</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to get nested dictionaries keys if they exists otherwise returns</span>
<span class="sd">        passed items.</span>
<span class="sd">        :param items: bag of items to include or exclude</span>
<span class="sd">        :type items:  Union[Set, Dict, None]</span>
<span class="sd">        :param key: name of the child to extract</span>
<span class="sd">        :type key: str</span>
<span class="sd">        :return: child extracted from items if exists</span>
<span class="sd">        :rtype: Union[Set, Dict, None]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">items</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">return</span> <span class="n">items</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_populate_pk_column</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;ModelRow&quot;</span><span class="p">]],</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">use_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds primary key column/alias (depends on use_alias flag) to list of</span>
<span class="sd">        column names that are selected.</span>

<span class="sd">        :param model: model on columns are selected</span>
<span class="sd">        :type model: Type[&quot;Model&quot;]</span>
<span class="sd">        :param columns: list of columns names</span>
<span class="sd">        :type columns: List[str]</span>
<span class="sd">        :param use_alias: flag to set if aliases or field names should be used</span>
<span class="sd">        :type use_alias: bool</span>
<span class="sd">        :return: list of columns names with pk column in it</span>
<span class="sd">        :rtype: List[str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pk_alias</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">get_column_alias</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">pkname</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">use_alias</span>
            <span class="k">else</span> <span class="n">model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">pkname</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">pk_alias</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pk_alias</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">columns</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">own_table_columns</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;ModelRow&quot;</span><span class="p">]],</span>
        <span class="n">excludable</span><span class="p">:</span> <span class="n">ExcludableItems</span><span class="p">,</span>
        <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">use_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">add_pk_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of aliases or field names for given model.</span>
<span class="sd">        Aliases/names switch is use_alias flag.</span>

<span class="sd">        If provided only fields included in fields will be returned.</span>
<span class="sd">        If provided fields in exclude_fields will be excluded in return.</span>

<span class="sd">        Primary key field is always added and cannot be excluded (will be added anyway).</span>

<span class="sd">        :param add_pk_columns: flag if add primary key - always yes if ormar parses data</span>
<span class="sd">        :type add_pk_columns: bool</span>
<span class="sd">        :param alias: relation prefix</span>
<span class="sd">        :type alias: str</span>
<span class="sd">        :param excludable: structure of fields to include and exclude</span>
<span class="sd">        :type excludable: ExcludableItems</span>
<span class="sd">        :param model: model on columns are selected</span>
<span class="sd">        :type model: Type[&quot;Model&quot;]</span>
<span class="sd">        :param use_alias: flag if aliases or field names should be used</span>
<span class="sd">        :type use_alias: bool</span>
<span class="sd">        :return: list of column field names or aliases</span>
<span class="sd">        :rtype: List[str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model_excludable</span> <span class="o">=</span> <span class="n">excludable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_cls</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">model</span><span class="o">.</span><span class="n">get_column_name_from_alias</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">use_alias</span> <span class="k">else</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">]</span>
        <span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">model</span><span class="o">.</span><span class="n">get_column_name_from_alias</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">include</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">col</span>
                <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">field_names</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">is_included</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">exclude</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">col</span>
                <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">field_names</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">is_excluded</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="c1"># always has to return pk column for ormar to work</span>
        <span class="k">if</span> <span class="n">add_pk_columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_populate_pk_column</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">use_alias</span><span class="o">=</span><span class="n">use_alias</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">columns</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_update_excluded_with_related</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used during generation of the dict().</span>
<span class="sd">        To avoid cyclical references and max recurrence limit nested models have to</span>
<span class="sd">        exclude related models that are not mandatory.</span>

<span class="sd">        For a main model (not nested) only nullable related field names are added to</span>
<span class="sd">        exclusion, for nested models all related models are excluded.</span>

<span class="sd">        :param exclude: set/dict with fields to exclude</span>
<span class="sd">        :type exclude: Union[Set, Dict, None]</span>
<span class="sd">        :return: set or dict with excluded fields added.</span>
<span class="sd">        :rtype: Union[Set, Dict]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="n">exclude</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">related_set</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">extract_related_names</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exclude</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">}</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="n">exclude</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">related_set</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exclude</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># relations are handled in ormar - take only own fields (ellipsis in dict)</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exclude</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">Ellipsis</span><span class="p">}</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="n">exclude</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">related_set</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">exclude</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_update_excluded_with_pks_and_through</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">Set</span><span class="p">,</span> <span class="n">exclude_primary_keys</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">exclude_through_models</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates excluded names with name of pk column if exclude flag is set.</span>

<span class="sd">        :param exclude: set of names to exclude</span>
<span class="sd">        :type exclude: Set</span>
<span class="sd">        :param exclude_primary_keys: flag if the primary keys should be excluded</span>
<span class="sd">        :type exclude_primary_keys: bool</span>
<span class="sd">        :return: set updated with pk if flag is set</span>
<span class="sd">        :rtype: Set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">exclude_primary_keys</span><span class="p">:</span>
            <span class="n">exclude</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">pkname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exclude_through_models</span><span class="p">:</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="n">exclude</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">extract_through_names</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">exclude</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_names_to_exclude</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">excludable</span><span class="p">:</span> <span class="n">ExcludableItems</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a set of models field names that should be explicitly excluded</span>
<span class="sd">        during model initialization.</span>

<span class="sd">        Those fields will be set to None to avoid ormar/pydantic setting default</span>
<span class="sd">        values on them. They should be returned as None in any case.</span>

<span class="sd">        Used in parsing data from database rows that construct Models by initializing</span>
<span class="sd">        them with dicts constructed from those db rows.</span>

<span class="sd">        :param alias: alias of current relation</span>
<span class="sd">        :type alias: str</span>
<span class="sd">        :param excludable: structure of fields to include and exclude</span>
<span class="sd">        :type excludable: ExcludableItems</span>
<span class="sd">        :return: set of field names that should be excluded</span>
<span class="sd">        :rtype: Set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="bp">cls</span><span class="p">)</span>
        <span class="n">model_excludable</span> <span class="o">=</span> <span class="n">excludable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_cls</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">)</span>
        <span class="n">fields_names</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">extract_db_own_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">include</span><span class="p">:</span>
            <span class="n">fields_to_keep</span> <span class="o">=</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">include</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">fields_names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fields_to_keep</span> <span class="o">=</span> <span class="n">fields_names</span>

        <span class="n">fields_to_exclude</span> <span class="o">=</span> <span class="n">fields_names</span> <span class="o">-</span> <span class="n">fields_to_keep</span>

        <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">exclude</span><span class="p">:</span>
            <span class="n">fields_to_exclude</span> <span class="o">=</span> <span class="n">fields_to_exclude</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
                <span class="n">model_excludable</span><span class="o">.</span><span class="n">exclude</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">fields_names</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">fields_to_exclude</span> <span class="o">=</span> <span class="n">fields_to_exclude</span> <span class="o">-</span> <span class="p">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">pkname</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">fields_to_exclude</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.ExcludableMixin.get_child" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_child</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Used to get nested dictionaries keys if they exists otherwise returns
passed items.
:param items: bag of items to include or exclude
:type items:  Union[Set, Dict, None]
:param key: name of the child to extract
:type key: str
:return: child extracted from items if exists
:rtype: Union[Set, Dict, None]</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/excludable_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_child</span><span class="p">(</span>
    <span class="n">items</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to get nested dictionaries keys if they exists otherwise returns</span>
<span class="sd">    passed items.</span>
<span class="sd">    :param items: bag of items to include or exclude</span>
<span class="sd">    :type items:  Union[Set, Dict, None]</span>
<span class="sd">    :param key: name of the child to extract</span>
<span class="sd">    :type key: str</span>
<span class="sd">    :return: child extracted from items if exists</span>
<span class="sd">    :rtype: Union[Set, Dict, None]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">items</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">return</span> <span class="n">items</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.ExcludableMixin.get_names_to_exclude" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_names_to_exclude</span><span class="p">(</span><span class="n">excludable</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Returns a set of models field names that should be explicitly excluded
during model initialization.</p>
<p>Those fields will be set to None to avoid ormar/pydantic setting default
values on them. They should be returned as None in any case.</p>
<p>Used in parsing data from database rows that construct Models by initializing
them with dicts constructed from those db rows.</p>
<p>:param alias: alias of current relation
:type alias: str
:param excludable: structure of fields to include and exclude
:type excludable: ExcludableItems
:return: set of field names that should be excluded
:rtype: Set</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/excludable_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_names_to_exclude</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">excludable</span><span class="p">:</span> <span class="n">ExcludableItems</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a set of models field names that should be explicitly excluded</span>
<span class="sd">    during model initialization.</span>

<span class="sd">    Those fields will be set to None to avoid ormar/pydantic setting default</span>
<span class="sd">    values on them. They should be returned as None in any case.</span>

<span class="sd">    Used in parsing data from database rows that construct Models by initializing</span>
<span class="sd">    them with dicts constructed from those db rows.</span>

<span class="sd">    :param alias: alias of current relation</span>
<span class="sd">    :type alias: str</span>
<span class="sd">    :param excludable: structure of fields to include and exclude</span>
<span class="sd">    :type excludable: ExcludableItems</span>
<span class="sd">    :return: set of field names that should be excluded</span>
<span class="sd">    :rtype: Set</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="bp">cls</span><span class="p">)</span>
    <span class="n">model_excludable</span> <span class="o">=</span> <span class="n">excludable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_cls</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">)</span>
    <span class="n">fields_names</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">extract_db_own_fields</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">include</span><span class="p">:</span>
        <span class="n">fields_to_keep</span> <span class="o">=</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">include</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">fields_names</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fields_to_keep</span> <span class="o">=</span> <span class="n">fields_names</span>

    <span class="n">fields_to_exclude</span> <span class="o">=</span> <span class="n">fields_names</span> <span class="o">-</span> <span class="n">fields_to_keep</span>

    <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">exclude</span><span class="p">:</span>
        <span class="n">fields_to_exclude</span> <span class="o">=</span> <span class="n">fields_to_exclude</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
            <span class="n">model_excludable</span><span class="o">.</span><span class="n">exclude</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">fields_names</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="n">fields_to_exclude</span> <span class="o">=</span> <span class="n">fields_to_exclude</span> <span class="o">-</span> <span class="p">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">pkname</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">fields_to_exclude</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.ExcludableMixin.own_table_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">own_table_columns</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">excludable</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">use_alias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_pk_columns</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Returns list of aliases or field names for given model.
Aliases/names switch is use_alias flag.</p>
<p>If provided only fields included in fields will be returned.
If provided fields in exclude_fields will be excluded in return.</p>
<p>Primary key field is always added and cannot be excluded (will be added anyway).</p>
<p>:param add_pk_columns: flag if add primary key - always yes if ormar parses data
:type add_pk_columns: bool
:param alias: relation prefix
:type alias: str
:param excludable: structure of fields to include and exclude
:type excludable: ExcludableItems
:param model: model on columns are selected
:type model: Type["Model"]
:param use_alias: flag if aliases or field names should be used
:type use_alias: bool
:return: list of column field names or aliases
:rtype: List[str]</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/excludable_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">own_table_columns</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;ModelRow&quot;</span><span class="p">]],</span>
    <span class="n">excludable</span><span class="p">:</span> <span class="n">ExcludableItems</span><span class="p">,</span>
    <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">use_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">add_pk_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns list of aliases or field names for given model.</span>
<span class="sd">    Aliases/names switch is use_alias flag.</span>

<span class="sd">    If provided only fields included in fields will be returned.</span>
<span class="sd">    If provided fields in exclude_fields will be excluded in return.</span>

<span class="sd">    Primary key field is always added and cannot be excluded (will be added anyway).</span>

<span class="sd">    :param add_pk_columns: flag if add primary key - always yes if ormar parses data</span>
<span class="sd">    :type add_pk_columns: bool</span>
<span class="sd">    :param alias: relation prefix</span>
<span class="sd">    :type alias: str</span>
<span class="sd">    :param excludable: structure of fields to include and exclude</span>
<span class="sd">    :type excludable: ExcludableItems</span>
<span class="sd">    :param model: model on columns are selected</span>
<span class="sd">    :type model: Type[&quot;Model&quot;]</span>
<span class="sd">    :param use_alias: flag if aliases or field names should be used</span>
<span class="sd">    :type use_alias: bool</span>
<span class="sd">    :return: list of column field names or aliases</span>
<span class="sd">    :rtype: List[str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_excludable</span> <span class="o">=</span> <span class="n">excludable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_cls</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">model</span><span class="o">.</span><span class="n">get_column_name_from_alias</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">use_alias</span> <span class="k">else</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">]</span>
    <span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">model</span><span class="o">.</span><span class="n">get_column_name_from_alias</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">include</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">col</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">field_names</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">is_included</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">if</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">exclude</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">col</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">field_names</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">model_excludable</span><span class="o">.</span><span class="n">is_excluded</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="c1"># always has to return pk column for ormar to work</span>
    <span class="k">if</span> <span class="n">add_pk_columns</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_populate_pk_column</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">use_alias</span><span class="o">=</span><span class="n">use_alias</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">columns</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ormar.models.mixins.MergeModelMixin" class="doc doc-heading">
            <code>MergeModelMixin</code>


</h2>


    <div class="doc doc-contents ">


      <p>Used to merge models instances returned by database,
but already initialized to ormar Models.keys</p>
<p>Models can duplicate during joins when parent model has multiple child rows,
in the end all parent (main) models should be unique.</p>

              <details class="quote">
                <summary>Source code in <code>ormar/models/mixins/merge_mixin.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MergeModelMixin</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to merge models instances returned by database,</span>
<span class="sd">    but already initialized to ormar Models.keys</span>

<span class="sd">    Models can duplicate during joins when parent model has multiple child rows,</span>
<span class="sd">    in the end all parent (main) models should be unique.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_recursive_add</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_group</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instead of accumulating the model additions one by one, this recursively adds</span>
<span class="sd">        the models. E.G.</span>
<span class="sd">        [1, 2, 3, 4].accumulate_add() would give [3, 3, 4], then [6, 4], then [10]</span>
<span class="sd">        where this method looks like</span>
<span class="sd">        [1, 2, 3, 4].recursive_add() gives [[3], [7]], [10]</span>
<span class="sd">        It&#39;s the same number of adds, but it gives better O(N) performance on sublists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_group</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model_group</span>

        <span class="n">added_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">iterable_group</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">model_group</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">iterable_group</span><span class="p">:</span>
            <span class="n">next_model</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterable_group</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">next_model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">combined</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">merge_two_instances</span><span class="p">(</span><span class="n">next_model</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">combined</span> <span class="o">=</span> <span class="n">model</span>
            <span class="n">added_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_recursive_add</span><span class="p">(</span><span class="n">added_values</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">merge_instances_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">result_rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges a list of models into list of unique models.</span>

<span class="sd">        Models can duplicate during joins when parent model has multiple child rows,</span>
<span class="sd">        in the end all parent (main) models should be unique.</span>

<span class="sd">        :param result_rows: list of already initialized Models with child models</span>
<span class="sd">        populated, each instance is one row in db and some models can duplicate</span>
<span class="sd">        :type result_rows: List[&quot;Model&quot;]</span>
<span class="sd">        :return: list of merged models where each main model is unique</span>
<span class="sd">        :rtype: List[&quot;Model&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">merged_rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">grouped_instances</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">result_rows</span><span class="p">:</span>
            <span class="n">grouped_instances</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pk</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_instances</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_recursive_add</span><span class="p">(</span><span class="n">group</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">merged_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">merged_rows</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">merge_two_instances</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">relation_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Model&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges current (other) Model and previous one (one) and returns the current</span>
<span class="sd">        Model instance with data merged from previous one.</span>

<span class="sd">        If needed it&#39;s calling itself recurrently and merges also children models.</span>

<span class="sd">        :param relation_map: map of models relations to follow</span>
<span class="sd">        :type relation_map: Dict</span>
<span class="sd">        :param one: previous model instance</span>
<span class="sd">        :type one: Model</span>
<span class="sd">        :param other: current model instance</span>
<span class="sd">        :type other: Model</span>
<span class="sd">        :return: current Model instance with data merged from previous one.</span>
<span class="sd">        :rtype: Model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relation_map</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">relation_map</span>
            <span class="k">if</span> <span class="n">relation_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">translate_list_to_dict</span><span class="p">(</span><span class="n">one</span><span class="o">.</span><span class="n">_iterate_related_models</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">relation_map</span><span class="p">:</span>
            <span class="n">current_field</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
            <span class="n">other_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_field</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">value_to_set</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_merge_items_lists</span><span class="p">(</span>
                    <span class="n">field_name</span><span class="o">=</span><span class="n">field_name</span><span class="p">,</span>
                    <span class="n">current_field</span><span class="o">=</span><span class="n">current_field</span><span class="p">,</span>
                    <span class="n">other_value</span><span class="o">=</span><span class="n">other_value</span><span class="p">,</span>
                    <span class="n">relation_map</span><span class="o">=</span><span class="n">relation_map</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">value_to_set</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_field</span><span class="p">,</span> <span class="n">ormar</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_value</span><span class="p">,</span> <span class="n">ormar</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">current_field</span><span class="o">.</span><span class="n">pk</span> <span class="o">==</span> <span class="n">other_value</span><span class="o">.</span><span class="n">pk</span>
            <span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span>
                    <span class="n">other</span><span class="p">,</span>
                    <span class="n">field_name</span><span class="p">,</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">merge_two_instances</span><span class="p">(</span>
                        <span class="n">current_field</span><span class="p">,</span>
                        <span class="n">other_value</span><span class="p">,</span>
                        <span class="n">relation_map</span><span class="o">=</span><span class="n">one</span><span class="o">.</span><span class="n">_skip_ellipsis</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
                            <span class="n">relation_map</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">default_return</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
                        <span class="p">),</span>
                    <span class="p">),</span>
                <span class="p">)</span>
        <span class="n">other</span><span class="o">.</span><span class="n">set_save_status</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">other</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_merge_items_lists</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">current_field</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
        <span class="n">other_value</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
        <span class="n">relation_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes two list of nested models and process them going deeper</span>
<span class="sd">        according with the map.</span>

<span class="sd">        If model from one&#39;s list is in other -&gt; they are merged with relations</span>
<span class="sd">        to follow passed from map.</span>

<span class="sd">        If one&#39;s model is not in other it&#39;s simply appended to the list.</span>

<span class="sd">        :param field_name: name of the current relation field</span>
<span class="sd">        :type field_name: str</span>
<span class="sd">        :param current_field: list of nested models from one model</span>
<span class="sd">        :type current_field: List[Model]</span>
<span class="sd">        :param other_value: list of nested models from other model</span>
<span class="sd">        :type other_value: List[Model]</span>
<span class="sd">        :param relation_map: map of relations to follow</span>
<span class="sd">        :type relation_map: Dict</span>
<span class="sd">        :return: merged list of models</span>
<span class="sd">        :rtype: List[Model]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value_to_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">other_value</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">cur_field</span> <span class="ow">in</span> <span class="n">current_field</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cur_field</span> <span class="ow">in</span> <span class="n">other_value</span><span class="p">:</span>
                <span class="n">old_value</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">other_value</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">cur_field</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">new_val</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">merge_two_instances</span><span class="p">(</span>
                    <span class="n">cur_field</span><span class="p">,</span>
                    <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">old_value</span><span class="p">),</span>
                    <span class="n">relation_map</span><span class="o">=</span><span class="n">cur_field</span><span class="o">.</span><span class="n">_skip_ellipsis</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
                        <span class="n">relation_map</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">default_return</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
                    <span class="p">),</span>
                <span class="p">)</span>
                <span class="n">value_to_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">value_to_set</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">cur_field</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_val</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_to_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur_field</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value_to_set</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.MergeModelMixin.merge_instances_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_instances_list</span><span class="p">(</span><span class="n">result_rows</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Merges a list of models into list of unique models.</p>
<p>Models can duplicate during joins when parent model has multiple child rows,
in the end all parent (main) models should be unique.</p>
<p>:param result_rows: list of already initialized Models with child models
populated, each instance is one row in db and some models can duplicate
:type result_rows: List["Model"]
:return: list of merged models where each main model is unique
:rtype: List["Model"]</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/merge_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">merge_instances_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">result_rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges a list of models into list of unique models.</span>

<span class="sd">    Models can duplicate during joins when parent model has multiple child rows,</span>
<span class="sd">    in the end all parent (main) models should be unique.</span>

<span class="sd">    :param result_rows: list of already initialized Models with child models</span>
<span class="sd">    populated, each instance is one row in db and some models can duplicate</span>
<span class="sd">    :type result_rows: List[&quot;Model&quot;]</span>
<span class="sd">    :return: list of merged models where each main model is unique</span>
<span class="sd">    :rtype: List[&quot;Model&quot;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">merged_rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">grouped_instances</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">result_rows</span><span class="p">:</span>
        <span class="n">grouped_instances</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pk</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_instances</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_recursive_add</span><span class="p">(</span><span class="n">group</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">merged_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">merged_rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.MergeModelMixin.merge_two_instances" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_two_instances</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">relation_map</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Merges current (other) Model and previous one (one) and returns the current
Model instance with data merged from previous one.</p>
<p>If needed it's calling itself recurrently and merges also children models.</p>
<p>:param relation_map: map of models relations to follow
:type relation_map: Dict
:param one: previous model instance
:type one: Model
:param other: current model instance
:type other: Model
:return: current Model instance with data merged from previous one.
:rtype: Model</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/merge_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">merge_two_instances</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">relation_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Model&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges current (other) Model and previous one (one) and returns the current</span>
<span class="sd">    Model instance with data merged from previous one.</span>

<span class="sd">    If needed it&#39;s calling itself recurrently and merges also children models.</span>

<span class="sd">    :param relation_map: map of models relations to follow</span>
<span class="sd">    :type relation_map: Dict</span>
<span class="sd">    :param one: previous model instance</span>
<span class="sd">    :type one: Model</span>
<span class="sd">    :param other: current model instance</span>
<span class="sd">    :type other: Model</span>
<span class="sd">    :return: current Model instance with data merged from previous one.</span>
<span class="sd">    :rtype: Model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">relation_map</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">relation_map</span>
        <span class="k">if</span> <span class="n">relation_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">translate_list_to_dict</span><span class="p">(</span><span class="n">one</span><span class="o">.</span><span class="n">_iterate_related_models</span><span class="p">())</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">relation_map</span><span class="p">:</span>
        <span class="n">current_field</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">other_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_field</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">value_to_set</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_merge_items_lists</span><span class="p">(</span>
                <span class="n">field_name</span><span class="o">=</span><span class="n">field_name</span><span class="p">,</span>
                <span class="n">current_field</span><span class="o">=</span><span class="n">current_field</span><span class="p">,</span>
                <span class="n">other_value</span><span class="o">=</span><span class="n">other_value</span><span class="p">,</span>
                <span class="n">relation_map</span><span class="o">=</span><span class="n">relation_map</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">value_to_set</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_field</span><span class="p">,</span> <span class="n">ormar</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_value</span><span class="p">,</span> <span class="n">ormar</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">current_field</span><span class="o">.</span><span class="n">pk</span> <span class="o">==</span> <span class="n">other_value</span><span class="o">.</span><span class="n">pk</span>
        <span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">other</span><span class="p">,</span>
                <span class="n">field_name</span><span class="p">,</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">merge_two_instances</span><span class="p">(</span>
                    <span class="n">current_field</span><span class="p">,</span>
                    <span class="n">other_value</span><span class="p">,</span>
                    <span class="n">relation_map</span><span class="o">=</span><span class="n">one</span><span class="o">.</span><span class="n">_skip_ellipsis</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
                        <span class="n">relation_map</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">default_return</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
                    <span class="p">),</span>
                <span class="p">),</span>
            <span class="p">)</span>
    <span class="n">other</span><span class="o">.</span><span class="n">set_save_status</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">other</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ormar.models.mixins.PydanticMixin" class="doc doc-heading">
            <code>PydanticMixin</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ormar.models.mixins.relation_mixin.RelationMixin" href="relation_mixin/#ormar.models.mixins.relation_mixin.RelationMixin">RelationMixin</a></code></p>


              <details class="quote">
                <summary>Source code in <code>ormar/models/mixins/pydantic_mixin.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PydanticMixin</span><span class="p">(</span><span class="n">RelationMixin</span><span class="p">):</span>
    <span class="n">__cache__</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="n">__pydantic_decorators__</span><span class="p">:</span> <span class="n">DecoratorInfos</span>
        <span class="n">model_fields</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FieldInfo</span><span class="p">]</span>
        <span class="n">_skip_ellipsis</span><span class="p">:</span> <span class="n">Callable</span>
        <span class="n">_get_not_excluded_fields</span><span class="p">:</span> <span class="n">Callable</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_pydantic</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pydantic model out of ormar model.</span>

<span class="sd">        Converts also nested ormar models into pydantic models.</span>

<span class="sd">        Can be used to fully exclude certain fields in fastapi response and requests.</span>

<span class="sd">        :param include: fields of own and nested models to include</span>
<span class="sd">        :type include: Union[Set, Dict, None]</span>
<span class="sd">        :param exclude: fields of own and nested models to exclude</span>
<span class="sd">        :type exclude: Union[Set, Dict, None]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relation_map</span> <span class="o">=</span> <span class="n">translate_list_to_dict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_iterate_related_models</span><span class="p">())</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_convert_ormar_to_pydantic</span><span class="p">(</span>
            <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">relation_map</span><span class="o">=</span><span class="n">relation_map</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_convert_ormar_to_pydantic</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">relation_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">include</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">Set</span><span class="p">):</span>
            <span class="n">include</span> <span class="o">=</span> <span class="n">translate_list_to_dict</span><span class="p">(</span><span class="n">include</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exclude</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exclude</span><span class="p">,</span> <span class="n">Set</span><span class="p">):</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="n">translate_list_to_dict</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span>
        <span class="n">fields_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">defaults</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">fields_to_process</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_not_excluded_fields</span><span class="p">(</span>
            <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="o">*</span><span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">()},</span>
            <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span>
            <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fields_to_process</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">cache_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">include</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__cache__</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__cache__</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fields_to_process</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_determine_pydantic_field_type</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">defaults</span><span class="o">=</span><span class="n">defaults</span><span class="p">,</span>
                <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span>
                <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
                <span class="n">relation_map</span><span class="o">=</span><span class="n">relation_map</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fields_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
        <span class="n">model</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">(</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">,),</span>
            <span class="p">{</span><span class="s2">&quot;__annotations__&quot;</span><span class="p">:</span> <span class="n">fields_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">defaults</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Type</span><span class="p">[</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">],</span> <span class="n">model</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_copy_field_validators</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">__cache__</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
        <span class="k">return</span> <span class="n">model</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_determine_pydantic_field_type</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">defaults</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">relation_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">is_relation</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relation_map</span><span class="p">:</span>
            <span class="n">target</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_determined_included_relation_field_type</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span>
                <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span>
                <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
                <span class="n">defaults</span><span class="o">=</span><span class="n">defaults</span><span class="p">,</span>
                <span class="n">relation_map</span><span class="o">=</span><span class="n">relation_map</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">is_relation</span><span class="p">:</span>
            <span class="n">defaults</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">default</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">__type__</span>
        <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">nullable</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">target</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_determined_included_relation_field_type</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">field</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseField</span><span class="p">,</span> <span class="n">ForeignKeyField</span><span class="p">,</span> <span class="n">ManyToManyField</span><span class="p">],</span>
        <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">defaults</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">relation_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">],</span> <span class="n">Dict</span><span class="p">]:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="n">_convert_ormar_to_pydantic</span><span class="p">(</span>
            <span class="n">include</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_skip_ellipsis</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
            <span class="n">exclude</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_skip_ellipsis</span><span class="p">(</span><span class="n">exclude</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
            <span class="n">relation_map</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_skip_ellipsis</span><span class="p">(</span><span class="n">relation_map</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default_return</span><span class="o">=</span><span class="nb">dict</span><span class="p">()),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">is_multi</span> <span class="ow">or</span> <span class="n">field</span><span class="o">.</span><span class="n">virtual</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">nullable</span><span class="p">:</span>
            <span class="n">defaults</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">target</span><span class="p">,</span> <span class="n">defaults</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_copy_field_validators</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copy field validators from ormar model to generated pydantic model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filed_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">copy_selected_validators_type</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">filed_names</span><span class="p">,</span> <span class="n">validator_type</span><span class="o">=</span><span class="s2">&quot;field_validators&quot;</span>
        <span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">copy_selected_validators_type</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">filed_names</span><span class="p">,</span> <span class="n">validator_type</span><span class="o">=</span><span class="s2">&quot;validators&quot;</span>
        <span class="p">)</span>

        <span class="n">class_validators</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_decorators__</span><span class="o">.</span><span class="n">root_validators</span>
        <span class="n">model</span><span class="o">.</span><span class="n">__pydantic_decorators__</span><span class="o">.</span><span class="n">root_validators</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">class_validators</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">model_validators</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_decorators__</span><span class="o">.</span><span class="n">model_validators</span>
        <span class="n">model</span><span class="o">.</span><span class="n">__pydantic_decorators__</span><span class="o">.</span><span class="n">model_validators</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">model_validators</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">model_rebuild</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">copy_selected_validators_type</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">],</span> <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">validator_type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copy field validators from ormar model to generated pydantic model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">validators</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_decorators__</span><span class="p">,</span> <span class="n">validator_type</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">validators</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">field_name</span> <span class="ow">in</span> <span class="n">decorator</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">fields</span> <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">):</span>
                <span class="n">copied_decorator</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">decorator</span><span class="p">)</span>
                <span class="n">copied_decorator</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">field_name</span>
                    <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">decorator</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">fields</span>
                    <span class="k">if</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">fields</span>
                <span class="p">]</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">__pydantic_decorators__</span><span class="p">,</span> <span class="n">validator_type</span><span class="p">)[</span>
                    <span class="n">name</span>
                <span class="p">]</span> <span class="o">=</span> <span class="n">copied_decorator</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.PydanticMixin.copy_selected_validators_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy_selected_validators_type</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">validator_type</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Copy field validators from ormar model to generated pydantic model.</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/pydantic_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">copy_selected_validators_type</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">],</span> <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">validator_type</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copy field validators from ormar model to generated pydantic model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validators</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_decorators__</span><span class="p">,</span> <span class="n">validator_type</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">validators</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">field_name</span> <span class="ow">in</span> <span class="n">decorator</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">fields</span> <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">):</span>
            <span class="n">copied_decorator</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">decorator</span><span class="p">)</span>
            <span class="n">copied_decorator</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">field_name</span>
                <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">decorator</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">fields</span>
                <span class="k">if</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">fields</span>
            <span class="p">]</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">__pydantic_decorators__</span><span class="p">,</span> <span class="n">validator_type</span><span class="p">)[</span>
                <span class="n">name</span>
            <span class="p">]</span> <span class="o">=</span> <span class="n">copied_decorator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.PydanticMixin.get_pydantic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pydantic</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Returns a pydantic model out of ormar model.</p>
<p>Converts also nested ormar models into pydantic models.</p>
<p>Can be used to fully exclude certain fields in fastapi response and requests.</p>
<p>:param include: fields of own and nested models to include
:type include: Union[Set, Dict, None]
:param exclude: fields of own and nested models to exclude
:type exclude: Union[Set, Dict, None]</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/pydantic_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_pydantic</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">pydantic</span><span class="o">.</span><span class="n">BaseModel</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a pydantic model out of ormar model.</span>

<span class="sd">    Converts also nested ormar models into pydantic models.</span>

<span class="sd">    Can be used to fully exclude certain fields in fastapi response and requests.</span>

<span class="sd">    :param include: fields of own and nested models to include</span>
<span class="sd">    :type include: Union[Set, Dict, None]</span>
<span class="sd">    :param exclude: fields of own and nested models to exclude</span>
<span class="sd">    :type exclude: Union[Set, Dict, None]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">relation_map</span> <span class="o">=</span> <span class="n">translate_list_to_dict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_iterate_related_models</span><span class="p">())</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_convert_ormar_to_pydantic</span><span class="p">(</span>
        <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">relation_map</span><span class="o">=</span><span class="n">relation_map</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ormar.models.mixins.SavePrepareMixin" class="doc doc-heading">
            <code>SavePrepareMixin</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ormar.models.mixins.relation_mixin.RelationMixin" href="relation_mixin/#ormar.models.mixins.relation_mixin.RelationMixin">RelationMixin</a></code>, <code><a class="autorefs autorefs-internal" title="ormar.models.mixins.AliasMixin" href="#ormar.models.mixins.AliasMixin">AliasMixin</a></code></p>


      <p>Used to prepare models to be saved in database</p>

              <details class="quote">
                <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SavePrepareMixin</span><span class="p">(</span><span class="n">RelationMixin</span><span class="p">,</span> <span class="n">AliasMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to prepare models to be saved in database</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>  <span class="c1"># pragma: nocover</span>
        <span class="n">_skip_ellipsis</span><span class="p">:</span> <span class="n">Callable</span>
        <span class="n">_json_fields</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="n">_bytes_fields</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="n">__pydantic_core_schema__</span><span class="p">:</span> <span class="n">CoreSchema</span>
        <span class="n">__ormar_fields_validators__</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
            <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SchemaValidator</span> <span class="o">|</span> <span class="n">PluggableSchemaValidator</span><span class="p">]</span>
        <span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">prepare_model_to_save</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Combines all preparation methods before saving.</span>
<span class="sd">        Removes primary key for if it&#39;s nullable or autoincrement pk field,</span>
<span class="sd">        and it&#39;s set to None.</span>
<span class="sd">        Substitute related models with their primary key values as fk column.</span>
<span class="sd">        Populates the default values for field with default set and no value.</span>
<span class="sd">        Translate columns into aliases (db names).</span>

<span class="sd">        :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">        :type new_kwargs: Dict[str, str]</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict[str, str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_remove_pk_from_kwargs</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_remove_not_ormar_fields</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">substitute_models_with_pks</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">populate_default_values</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">reconvert_str_to_bytes</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">translate_columns_to_aliases</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">prepare_model_to_update</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Combines all preparation methods before updating.</span>
<span class="sd">        :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">        :type new_kwargs: Dict[str, str]</span>
<span class="sd">        :return: dictionary of model that is about to be updated</span>
<span class="sd">        :rtype: Dict[str, str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">parse_non_db_fields</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">substitute_models_with_pks</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">reconvert_str_to_bytes</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dump_all_json_fields_to_str</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">translate_columns_to_aliases</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">translate_enum_columns</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">translate_enum_columns</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
                <span class="n">new_kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_remove_not_ormar_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes primary key for if it&#39;s nullable or autoincrement pk field,</span>
<span class="sd">        and it&#39;s set to None.</span>

<span class="sd">        :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">        :type new_kwargs: Dict[str, str]</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict[str, str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ormar_fields</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ormar_fields</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_remove_pk_from_kwargs</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes primary key for if it&#39;s nullable or autoincrement pk field,</span>
<span class="sd">        and it&#39;s set to None.</span>

<span class="sd">        :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">        :type new_kwargs: Dict[str, str]</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict[str, str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pkname</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">pkname</span>
        <span class="n">pk</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">pkname</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pkname</span><span class="p">,</span> <span class="n">ormar</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">pk</span><span class="o">.</span><span class="n">nullable</span> <span class="ow">or</span> <span class="n">pk</span><span class="o">.</span><span class="n">autoincrement</span>
        <span class="p">):</span>
            <span class="k">del</span> <span class="n">new_kwargs</span><span class="p">[</span><span class="n">pkname</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse_non_db_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receives dictionary of model that is about to be saved and changes uuid fields</span>
<span class="sd">        to strings in bulk_update.</span>

<span class="sd">        :param model_dict: dictionary of model that is about to be saved</span>
<span class="sd">        :type model_dict: Dict</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">__type__</span> <span class="o">==</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="p">:</span>
                <span class="n">parsers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;string&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;hex&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%.32x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="o">.</span><span class="n">int</span><span class="p">}</span>
                <span class="n">uuid_format</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">column_type</span><span class="o">.</span><span class="n">uuid_format</span>
                <span class="n">parser</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uuid_format</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
                <span class="n">model_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="n">model_dict</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">model_dict</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">substitute_models_with_pks</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>  <span class="c1"># noqa  CCR001</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receives dictionary of model that is about to be saved and changes all related</span>
<span class="sd">        models that are stored as foreign keys to their fk value.</span>

<span class="sd">        :param model_dict: dictionary of model that is about to be saved</span>
<span class="sd">        :type model_dict: Dict</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">extract_related_names</span><span class="p">():</span>
            <span class="n">field_value</span> <span class="o">=</span> <span class="n">model_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">target_field</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
                <span class="n">target_pkname</span> <span class="o">=</span> <span class="n">target_field</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">pkname</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">ormar</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
                    <span class="n">pk_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">target_pkname</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">pk_value</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ModelPersistenceError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;You cannot save </span><span class="si">{</span><span class="n">field_value</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;model without pk set!&quot;</span>
                        <span class="p">)</span>
                    <span class="n">model_dict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">pk_value</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">))</span> <span class="ow">and</span> <span class="n">field_value</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">model_dict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">target</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_pkname</span><span class="p">)</span> <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">field_value</span>
                        <span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">model_dict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_pkname</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">model_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model_dict</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">reconvert_str_to_bytes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receives dictionary of model that is about to be saved and changes</span>
<span class="sd">        all bytes fields that are represented as strings back into bytes.</span>

<span class="sd">        :param model_dict: dictionary of model that is about to be saved</span>
<span class="sd">        :type model_dict: Dict</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bytes_base64_fields</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">represent_as_base64_str</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_bytes_fields</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">model_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bytes_base64_fields</span>
                    <span class="k">else</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">model_dict</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">dump_all_json_fields_to_str</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receives dictionary of model that is about to be saved and changes</span>
<span class="sd">        all json fields into strings</span>

<span class="sd">        :param model_dict: dictionary of model that is about to be saved</span>
<span class="sd">        :type model_dict: Dict</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_json_fields</span><span class="p">:</span>
                <span class="n">model_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">encode_json</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model_dict</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">populate_default_values</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receives dictionary of model that is about to be saved and populates the default</span>
<span class="sd">        value on the fields that have the default value set, but no actual value was</span>
<span class="sd">        passed by the user.</span>

<span class="sd">        :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">        :type new_kwargs: Dict</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_kwargs</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">has_default</span><span class="p">(</span><span class="n">use_server</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">new_kwargs</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">get_default</span><span class="p">()</span>
            <span class="c1"># clear fields with server_default set as None</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">field</span><span class="o">.</span><span class="n">server_default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="p">):</span>
                <span class="n">new_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">validate_enums</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receives dictionary of model that is about to be saved and validates the</span>
<span class="sd">        fields with choices set to see if the value is allowed.</span>

<span class="sd">        :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">        :type new_kwargs: Dict</span>
<span class="sd">        :return: dictionary of model that is about to be saved</span>
<span class="sd">        :rtype: Dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">validators</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_build_individual_schema_validator</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">validators</span><span class="p">:</span>
                <span class="n">validators</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">validate_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_build_individual_schema_validator</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__ormar_fields_validators__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__ormar_fields_validators__</span>
        <span class="n">field_validators</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_extract_pydantic_fields</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;definitions&quot;</span><span class="p">:</span>
                <span class="n">schema</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;definitions&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;definitions&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">[</span><span class="s2">&quot;definitions&quot;</span><span class="p">],</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">schema</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span>
            <span class="n">field_validators</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_schema_validator</span><span class="p">(</span>
                <span class="n">schema</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__qualname__</span><span class="p">,</span> <span class="s2">&quot;BaseModel&quot;</span>
            <span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">__ormar_fields_validators__</span> <span class="o">=</span> <span class="n">field_validators</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__ormar_fields_validators__</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_extract_pydantic_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">][</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;definitions&quot;</span><span class="p">:</span>
            <span class="n">main_schema</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;schema_ref&quot;</span> <span class="ow">in</span> <span class="n">main_schema</span><span class="p">:</span>
                <span class="n">reference_id</span> <span class="o">=</span> <span class="n">main_schema</span><span class="p">[</span><span class="s2">&quot;schema_ref&quot;</span><span class="p">]</span>
                <span class="k">return</span> <span class="nb">next</span><span class="p">(</span>
                    <span class="n">ref</span>
                    <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">[</span><span class="s2">&quot;definitions&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">ref</span><span class="p">[</span><span class="s2">&quot;ref&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">reference_id</span>
                <span class="p">)[</span><span class="s2">&quot;schema&quot;</span><span class="p">][</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">main_schema</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">][</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_upsert_model</span><span class="p">(</span>
        <span class="n">instance</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span>
        <span class="n">save_all</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">previous_model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span>
        <span class="n">relation_field</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;ForeignKeyField&quot;</span><span class="p">],</span>
        <span class="n">update_count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method updates given instance if:</span>

<span class="sd">        * instance is not saved or</span>
<span class="sd">        * instance have no pk or</span>
<span class="sd">        * save_all=True flag is set</span>

<span class="sd">        and instance is not __pk_only__.</span>

<span class="sd">        If relation leading to instance is a ManyToMany also the through model is saved</span>

<span class="sd">        :param instance: current model to upsert</span>
<span class="sd">        :type instance: Model</span>
<span class="sd">        :param save_all: flag if all models should be saved or only not saved ones</span>
<span class="sd">        :type save_all: bool</span>
<span class="sd">        :param relation_field: field with relation</span>
<span class="sd">        :type relation_field: Optional[ForeignKeyField]</span>
<span class="sd">        :param previous_model: previous model from which method came</span>
<span class="sd">        :type previous_model: Model</span>
<span class="sd">        :param update_count: no of updated models</span>
<span class="sd">        :type update_count: int</span>
<span class="sd">        :return: no of updated models</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">save_all</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">instance</span><span class="o">.</span><span class="n">pk</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">instance</span><span class="o">.</span><span class="n">saved</span>
        <span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">instance</span><span class="o">.</span><span class="n">__pk_only__</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">instance</span><span class="o">.</span><span class="n">upsert</span><span class="p">(</span><span class="n">__force_save__</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">relation_field</span> <span class="ow">and</span> <span class="n">relation_field</span><span class="o">.</span><span class="n">is_multi</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">instance</span><span class="o">.</span><span class="n">_upsert_through_model</span><span class="p">(</span>
                    <span class="n">instance</span><span class="o">=</span><span class="n">instance</span><span class="p">,</span>
                    <span class="n">relation_field</span><span class="o">=</span><span class="n">relation_field</span><span class="p">,</span>
                    <span class="n">previous_model</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">previous_model</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="n">update_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">update_count</span>

    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_upsert_through_model</span><span class="p">(</span>
        <span class="n">instance</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">previous_model</span><span class="p">:</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">relation_field</span><span class="p">:</span> <span class="s2">&quot;ForeignKeyField&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upsert through model for m2m relation.</span>

<span class="sd">        :param instance: current model to upsert</span>
<span class="sd">        :type instance: Model</span>
<span class="sd">        :param relation_field: field with relation</span>
<span class="sd">        :type relation_field: Optional[ForeignKeyField]</span>
<span class="sd">        :param previous_model: previous model from which method came</span>
<span class="sd">        :type previous_model: Model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">through_name</span> <span class="o">=</span> <span class="n">previous_model</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span>
            <span class="n">relation_field</span><span class="o">.</span><span class="n">name</span>
        <span class="p">]</span><span class="o">.</span><span class="n">through</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="n">through</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">through_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">through</span><span class="p">:</span>
            <span class="n">through_dict</span> <span class="o">=</span> <span class="n">through</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">through</span><span class="o">.</span><span class="n">extract_related_names</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">through_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">await</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">previous_model</span><span class="p">,</span> <span class="n">relation_field</span><span class="o">.</span><span class="n">name</span>
        <span class="p">)</span><span class="o">.</span><span class="n">queryset_proxy</span><span class="o">.</span><span class="n">upsert_through_instance</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="o">**</span><span class="n">through_dict</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_update_relation_list</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fields_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="s2">&quot;ForeignKeyField&quot;</span><span class="p">],</span>
        <span class="n">follow</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">save_all</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">relation_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">update_count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal method used in save_related to follow deeper from</span>
<span class="sd">        related models and update numbers of updated related instances.</span>

<span class="sd">        :type save_all: flag if all models should be saved</span>
<span class="sd">        :type save_all: bool</span>
<span class="sd">        :param fields_list: list of ormar fields to follow and save</span>
<span class="sd">        :type fields_list: Collection[&quot;ForeignKeyField&quot;]</span>
<span class="sd">        :param relation_map: map of relations to follow</span>
<span class="sd">        :type relation_map: Dict</span>
<span class="sd">        :param follow: flag to trigger deep save -</span>
<span class="sd">        by default only directly related models are saved</span>
<span class="sd">        with follow=True also related models of related models are saved</span>
<span class="sd">        :type follow: bool</span>
<span class="sd">        :param update_count: internal parameter for recursive calls -</span>
<span class="sd">        number of updated instances</span>
<span class="sd">        :type update_count: int</span>
<span class="sd">        :return: tuple of update count and visited</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_list</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_values</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">follow</span><span class="p">:</span>
                    <span class="n">update_count</span> <span class="o">=</span> <span class="k">await</span> <span class="n">value</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span>
                        <span class="n">follow</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
                        <span class="n">save_all</span><span class="o">=</span><span class="n">save_all</span><span class="p">,</span>
                        <span class="n">relation_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_skip_ellipsis</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
                            <span class="n">relation_map</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">default_return</span><span class="o">=</span><span class="p">{}</span>
                        <span class="p">),</span>
                        <span class="n">update_count</span><span class="o">=</span><span class="n">update_count</span><span class="p">,</span>
                        <span class="n">previous_model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">relation_field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">update_count</span> <span class="o">=</span> <span class="k">await</span> <span class="n">value</span><span class="o">.</span><span class="n">_upsert_model</span><span class="p">(</span>
                        <span class="n">instance</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
                        <span class="n">save_all</span><span class="o">=</span><span class="n">save_all</span><span class="p">,</span>
                        <span class="n">previous_model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">relation_field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span>
                        <span class="n">update_count</span><span class="o">=</span><span class="n">update_count</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="n">update_count</span>

    <span class="k">def</span> <span class="nf">_get_field_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract field values and ensures it is a list.</span>

<span class="sd">        :param name: name of the field</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :return: list of values</span>
<span class="sd">        :rtype: List</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">values</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.SavePrepareMixin.dump_all_json_fields_to_str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dump_all_json_fields_to_str</span><span class="p">(</span><span class="n">model_dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Receives dictionary of model that is about to be saved and changes
all json fields into strings</p>
<p>:param model_dict: dictionary of model that is about to be saved
:type model_dict: Dict
:return: dictionary of model that is about to be saved
:rtype: Dict</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">dump_all_json_fields_to_str</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Receives dictionary of model that is about to be saved and changes</span>
<span class="sd">    all json fields into strings</span>

<span class="sd">    :param model_dict: dictionary of model that is about to be saved</span>
<span class="sd">    :type model_dict: Dict</span>
<span class="sd">    :return: dictionary of model that is about to be saved</span>
<span class="sd">    :rtype: Dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_json_fields</span><span class="p">:</span>
            <span class="n">model_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">encode_json</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.SavePrepareMixin.parse_non_db_fields" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_non_db_fields</span><span class="p">(</span><span class="n">model_dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Receives dictionary of model that is about to be saved and changes uuid fields
to strings in bulk_update.</p>
<p>:param model_dict: dictionary of model that is about to be saved
:type model_dict: Dict
:return: dictionary of model that is about to be saved
:rtype: Dict</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">parse_non_db_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Receives dictionary of model that is about to be saved and changes uuid fields</span>
<span class="sd">    to strings in bulk_update.</span>

<span class="sd">    :param model_dict: dictionary of model that is about to be saved</span>
<span class="sd">    :type model_dict: Dict</span>
<span class="sd">    :return: dictionary of model that is about to be saved</span>
<span class="sd">    :rtype: Dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">__type__</span> <span class="o">==</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="p">:</span>
            <span class="n">parsers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;string&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;hex&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%.32x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="o">.</span><span class="n">int</span><span class="p">}</span>
            <span class="n">uuid_format</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">column_type</span><span class="o">.</span><span class="n">uuid_format</span>
            <span class="n">parser</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uuid_format</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">model_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="n">model_dict</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.SavePrepareMixin.populate_default_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">populate_default_values</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Receives dictionary of model that is about to be saved and populates the default
value on the fields that have the default value set, but no actual value was
passed by the user.</p>
<p>:param new_kwargs: dictionary of model that is about to be saved
:type new_kwargs: Dict
:return: dictionary of model that is about to be saved
:rtype: Dict</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">populate_default_values</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Receives dictionary of model that is about to be saved and populates the default</span>
<span class="sd">    value on the fields that have the default value set, but no actual value was</span>
<span class="sd">    passed by the user.</span>

<span class="sd">    :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">    :type new_kwargs: Dict</span>
<span class="sd">    :return: dictionary of model that is about to be saved</span>
<span class="sd">    :rtype: Dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_kwargs</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">has_default</span><span class="p">(</span><span class="n">use_server</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">new_kwargs</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">get_default</span><span class="p">()</span>
        <span class="c1"># clear fields with server_default set as None</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">field</span><span class="o">.</span><span class="n">server_default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">new_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.SavePrepareMixin.prepare_model_to_save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_model_to_save</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Combines all preparation methods before saving.
Removes primary key for if it's nullable or autoincrement pk field,
and it's set to None.
Substitute related models with their primary key values as fk column.
Populates the default values for field with default set and no value.
Translate columns into aliases (db names).</p>
<p>:param new_kwargs: dictionary of model that is about to be saved
:type new_kwargs: Dict[str, str]
:return: dictionary of model that is about to be saved
:rtype: Dict[str, str]</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">prepare_model_to_save</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Combines all preparation methods before saving.</span>
<span class="sd">    Removes primary key for if it&#39;s nullable or autoincrement pk field,</span>
<span class="sd">    and it&#39;s set to None.</span>
<span class="sd">    Substitute related models with their primary key values as fk column.</span>
<span class="sd">    Populates the default values for field with default set and no value.</span>
<span class="sd">    Translate columns into aliases (db names).</span>

<span class="sd">    :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">    :type new_kwargs: Dict[str, str]</span>
<span class="sd">    :return: dictionary of model that is about to be saved</span>
<span class="sd">    :rtype: Dict[str, str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_remove_pk_from_kwargs</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_remove_not_ormar_fields</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">substitute_models_with_pks</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">populate_default_values</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">reconvert_str_to_bytes</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">translate_columns_to_aliases</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.SavePrepareMixin.prepare_model_to_update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_model_to_update</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Combines all preparation methods before updating.
:param new_kwargs: dictionary of model that is about to be saved
:type new_kwargs: Dict[str, str]
:return: dictionary of model that is about to be updated
:rtype: Dict[str, str]</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">prepare_model_to_update</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Combines all preparation methods before updating.</span>
<span class="sd">    :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">    :type new_kwargs: Dict[str, str]</span>
<span class="sd">    :return: dictionary of model that is about to be updated</span>
<span class="sd">    :rtype: Dict[str, str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">parse_non_db_fields</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">substitute_models_with_pks</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">reconvert_str_to_bytes</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dump_all_json_fields_to_str</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">translate_columns_to_aliases</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">translate_enum_columns</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.SavePrepareMixin.reconvert_str_to_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reconvert_str_to_bytes</span><span class="p">(</span><span class="n">model_dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Receives dictionary of model that is about to be saved and changes
all bytes fields that are represented as strings back into bytes.</p>
<p>:param model_dict: dictionary of model that is about to be saved
:type model_dict: Dict
:return: dictionary of model that is about to be saved
:rtype: Dict</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">reconvert_str_to_bytes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Receives dictionary of model that is about to be saved and changes</span>
<span class="sd">    all bytes fields that are represented as strings back into bytes.</span>

<span class="sd">    :param model_dict: dictionary of model that is about to be saved</span>
<span class="sd">    :type model_dict: Dict</span>
<span class="sd">    :return: dictionary of model that is about to be saved</span>
<span class="sd">    :rtype: Dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bytes_base64_fields</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">represent_as_base64_str</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_bytes_fields</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">model_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bytes_base64_fields</span>
                <span class="k">else</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">model_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.SavePrepareMixin.substitute_models_with_pks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">substitute_models_with_pks</span><span class="p">(</span><span class="n">model_dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Receives dictionary of model that is about to be saved and changes all related
models that are stored as foreign keys to their fk value.</p>
<p>:param model_dict: dictionary of model that is about to be saved
:type model_dict: Dict
:return: dictionary of model that is about to be saved
:rtype: Dict</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">substitute_models_with_pks</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>  <span class="c1"># noqa  CCR001</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Receives dictionary of model that is about to be saved and changes all related</span>
<span class="sd">    models that are stored as foreign keys to their fk value.</span>

<span class="sd">    :param model_dict: dictionary of model that is about to be saved</span>
<span class="sd">    :type model_dict: Dict</span>
<span class="sd">    :return: dictionary of model that is about to be saved</span>
<span class="sd">    :rtype: Dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">extract_related_names</span><span class="p">():</span>
        <span class="n">field_value</span> <span class="o">=</span> <span class="n">model_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">target_field</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
            <span class="n">target_pkname</span> <span class="o">=</span> <span class="n">target_field</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="n">ormar_config</span><span class="o">.</span><span class="n">pkname</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">ormar</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
                <span class="n">pk_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">target_pkname</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">pk_value</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ModelPersistenceError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;You cannot save </span><span class="si">{</span><span class="n">field_value</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;model without pk set!&quot;</span>
                    <span class="p">)</span>
                <span class="n">model_dict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">pk_value</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">))</span> <span class="ow">and</span> <span class="n">field_value</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">model_dict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">target</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_pkname</span><span class="p">)</span> <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">field_value</span>
                    <span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">model_dict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_pkname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">model_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ormar.models.mixins.SavePrepareMixin.validate_enums" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_enums</span><span class="p">(</span><span class="n">new_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Receives dictionary of model that is about to be saved and validates the
fields with choices set to see if the value is allowed.</p>
<p>:param new_kwargs: dictionary of model that is about to be saved
:type new_kwargs: Dict
:return: dictionary of model that is about to be saved
:rtype: Dict</p>

            <details class="quote">
              <summary>Source code in <code>ormar/models/mixins/save_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">validate_enums</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Receives dictionary of model that is about to be saved and validates the</span>
<span class="sd">    fields with choices set to see if the value is allowed.</span>

<span class="sd">    :param new_kwargs: dictionary of model that is about to be saved</span>
<span class="sd">    :type new_kwargs: Dict</span>
<span class="sd">    :return: dictionary of model that is about to be saved</span>
<span class="sd">    :rtype: Dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validators</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_build_individual_schema_validator</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">validators</span><span class="p">:</span>
            <span class="n">validators</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">validate_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
      
        <script src="../../../javascripts/config.js"></script>
      
    
  </body>
</html>